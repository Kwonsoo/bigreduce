/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */
typedef unsigned int size_t;
typedef long long __quad_t;
typedef long __off_t;
typedef __quad_t __off64_t;
typedef long __time_t;
struct option {
   char const   *name ;
   int has_arg ;
   int *flag ;
   int val ;
};
struct _IO_FILE;
struct _IO_FILE;
typedef struct _IO_FILE FILE;
struct _IO_FILE;
typedef void _IO_lock_t;
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   int _mode ;
   char _unused2[15UL * sizeof(int ) - 2UL * sizeof(void *)] ;
};
typedef __time_t time_t;
struct tm {
   int tm_sec ;
   int tm_min ;
   int tm_hour ;
   int tm_mday ;
   int tm_mon ;
   int tm_year ;
   int tm_wday ;
   int tm_yday ;
   int tm_isdst ;
   long tm_gmtoff ;
   char const   *tm_zone ;
};
extern int optind ;
 ;
extern int fclose(FILE *__stream ) ;
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes ) ;
 ;
extern int printf(char const   * __restrict  __format  , ...) ;
 ;
extern int fscanf(FILE * __restrict  __stream , char const   * __restrict  __format 
                  , ...) ;
extern char *fgets(char * __restrict  __s , int __n , FILE * __restrict  __stream ) ;
extern  __attribute__((__nothrow__)) int feof(FILE *__stream ) ;
  ;
  ;
  ;
  ;
  
;
  ;
  
;
  ;
  
;
extern  __attribute__((__nothrow__, __noreturn__)) void exit(int __status ) ;
extern  __attribute__((__nothrow__)) double cos(double __x ) ;
extern  __attribute__((__nothrow__)) double sin(double __x ) ;
 ;
 ;
extern  __attribute__((__nothrow__)) double pow(double __x , double __y ) ;
extern  __attribute__((__nothrow__)) double sqrt(double __x ) ;
extern  __attribute__((__nothrow__)) double fabs(double __x )  __attribute__((__const__)) ;
 ;
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1))) memset)(void *__s ,
                                                                                     int __c ,
                                                                                     size_t __n ) ;
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2))) strcmp)(char const   *__s1 ,
                                                                                     char const   *__s2 )  __attribute__((__pure__)) ;
 ;
 ;
 ;
double const   KB  =    (double const   )1.380658e-23;
double const   Q  =    (double const   )1.60217733e-19;
double const   HBAR  =    (double const   )1.05457266e-34;
double const   EPS0  =    (double const   )8.854187817e-12;
double const   M  =    (double const   )9.1093897e-31;
double const   NI  =    (double const   )1.45e16;
double const   PI  =    (double const   )3.141592654;
double const   DE  =    (double const   )0.002;
double const   mstarHSILICON  =    (double const   )0.57;
double const   mstarHGERMANIUM  =    (double const   )0.73;
double const   mstarHGAAS  =    (double const   )0.510;
double MIU0  =    1400.e-4;
double VS  =    1.e5;
double mstarhole  =    0.57;
double MIU0hole  =    0.0471;
double VShole  =    1.e5;
double NGATE  =    3.9e11;
  
;
  
;
  
;
  
;
 double MM2(double x , double a , double b ) 
;
 ;
 ;
void media(void) ;
 ;
 ;
 ;
 ;
void SaveOutputFiles(int File_Format___0 , int c___0 ) ;
void Electric_Field(void) ;
void Faraday(void) ;
 ;
 ;
 ;
void EMC(void) ;
 ;
 ;
 void creation(int i , double t , int edge ) ;
void Charge(void) ;
void updating(int model ) ;
void Read_Input_File(void) ;
void Compute_Currents(void) ;
void electron_relaxation_step(void) ;
void ParabMEP2D(int nx___0 , int ny___0 , double dx___0 , double dy___0 , double cfl ,
                double theta ) ;
void HMEPBCs(void) ;
void MEP_coefficients(void) ;
void Hole_MEP2D(int nx___0 , int ny___0 , double dx___0 , double dy___0 , double cfl ,
                double theta ) ;
void HoleHMEPBCs(void) ;
void Relaxation_Step_Hole(void) ;
 double rnd(void) ;
double c11i(double t ) ;
double c12i(double t ) ;
 ;
 ;
 ;
 ;
 ;
 ;
double tauwi(double t ) ;
int NUM_VERT  ;
int NUM_EXAHEDRA  ;
int MEDIA  ;
int MAXIMINI  ;
int SAVEALWAYS  ;
int nx  ;
int ny  ;
int ISEED  ;
int NP1  ;
int INUM  ;
int IV  ;
int c  ;
int Model_Number  ;
int File_Format  ;
int Quantum_Flag  ;
int leid_flag  ;
int SIO2_UP_FLAG  ;
int SIO2_DOWN_FLAG  ;
int FARADAYFLAG  ;
int i_dom[309][309]  ;
int NOVALLEY[17]  ;
double u2d[309][309][5]  ;
double h2d[309][309][5]  ;
double PSI[309][309]  ;
double E[309][309][2]  ;
double N_D[309][309]  ;
double N_H[309][309]  ;
double dx  ;
double dy  ;
double TEMPO  =    0.;
double TF  ;
double LX  ;
double LY  ;
double TL  ;
double DT  ;
double mstar2  ;
double msh  ;
double BKTQ  ;
double QH  ;
double SMH[17][3]  ;
double HHM[17][3]  ;
double HM[17][3]  ;
double GM[17]  ;
double SWK[17][3][14][1004]  ;
double P[10000001][7]  ;
double KX  ;
double KY  ;
double KZ  ;
double X  ;
double Y  ;
double TS  ;
double EPP  ;
double DDmax  ;
double EDGE[4][617][4]  ;
double CIMP  ;
double QD2  ;
double TAUW  ;
double EPSRSIO2  ;
double bufx2d[309][309]  ;
double bufy2d[309][309]  ;
double ux2d[309][309][5]  ;
double uy2d[309][309][5]  ;
double f2d[309][309][5]  ;
double g2d[309][309][5]  ;
double fx2d[309][309][5]  ;
double gy2d[309][309][5]  ;
double c11[7]  ;
double c12[7]  ;
double c21[7]  ;
double c22[7]  ;
double u[7]  ;
double f[7]  ;
double g[7]  ;
double cw[7]  ;
double SIO2_INI[2]  ;
double SIO2_FIN[2]  ;
double SIO2_POT[2]  ;
double SIO2_THICKNESS[2]  ;
double SIO2[2][309][309]  ;
double B[309][309]  ;
double EPSR[17]  ;
double EPF[17]  ;
double MSTAR[17][6]  ;
double alphaK[17][4]  ;
double EG[17]  ;
double HWO[17][6]  ;
double DTK[17][6]  ;
double ZF[17][6]  ;
double RHO[17]  ;
double DA[17]  ;
double UL[17]  ;
double EMIN[17][4]  ;
double XVAL[17]  ;
time_t binarytime  ;
struct tm *nowtm  ;
struct option longopts[2]  = {      {"version", 0, (int *)((void *)0), 'v'}, 
        {"help", 0, (int *)((void *)0), 'h'}};
FILE *fp  ;
static char *progname  ;
int main(int argc , char **argv ) 
;
 
;
 
;
void media(void) 
;
 
;
 
;
 
;
 
;
void SaveOutputFiles(int File_Format___0 , int c___0 ) 
;
void Electric_Field(void) 
;
void Faraday(void) 
;
 
;
 double rnd(void) 
;
 
;
 
;
 void creation(int i , double t , int edge ) 
;
void EMC(void) 
;


void Charge(void) 
{ 
  int i ;
  int j ;
  int n ;
  double x ;
  double y ;
  {
  i = 1;
  {
  while (1) {
    while_continue: /* CIL Label */ ;
    if (! (i <= nx + 1)) {
      goto while_break;
    }
    j = 1;
    {
    while (1) {
      while_continue___0: /* CIL Label */ ;
      if (! (j <= ny + 1)) {
        goto while_break___0;
      }
      u2d[i][j][1] = 0.;
      j ++;
    }
    while_break___5: /* CIL Label */ ;
    }
    while_break___0: 
    i ++;
  }
  while_break___4: /* CIL Label */ ;
  }
  while_break: 
  n = 1;
  {
  while (1) {
    while_continue___1: /* CIL Label */ ;
    if (! (n <= INUM)) {
      goto while_break___1;
    }
    x = P[n][5] / dx;
    y = P[n][6] / dy;
    i = (int )(x + 1.);
    j = (int )(y + 1.);
    u2d[i][j][1] += (1. - (x - (double )(i - 1))) * (1. - (y - (double )(j - 1)));
    if (i <= nx) {
      u2d[i + 1][j][1] += (1. - (1. - (x - (double )(i - 1)))) * (1. - (y - (double )(j - 1)));
    }
    if (j <= ny) {
      u2d[i][j + 1][1] += (1. - (x - (double )(i - 1))) * (1. - (1. - (y - (double )(j - 1))));
    }
    if (i <= nx) {
      if (j <= ny) {
        u2d[i + 1][j + 1][1] += (1. - (1. - (x - (double )(i - 1)))) * (1. - (1. - (y - (double )(j - 1))));
      }
    }
    n ++;
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break___1: 
  i = 1;
  {
  while (1) {
    while_continue___2: /* CIL Label */ ;
    if (! (i <= nx + 1)) {
      goto while_break___2;
    }
    j = 1;
    {
    while (1) {
      while_continue___3: /* CIL Label */ ;
      if (! (j <= ny + 1)) {
        goto while_break___3;
      }
      u2d[i][j][1] *= EPP / (dx * dy);
      if (i == 1) {
        u2d[i][j][1] *= 2.;
      } else
      if (i == nx + 1) {
        u2d[i][j][1] *= 2.;
      }
      if (j == 1) {
        u2d[i][j][1] *= 2.;
      } else
      if (j == ny + 1) {
        u2d[i][j][1] *= 2.;
      }
      j ++;
    }
    while_break___8: /* CIL Label */ ;
    }
    while_break___3: 
    i ++;
  }
  while_break___7: /* CIL Label */ ;
  }
  while_break___2: 
  u2d[nx + 1][ny + 1][1] = u2d[nx][ny + 1][1];
  u2d[1][ny + 1][1] = u2d[1][ny][1];
  return;
}
}
void updating(int model ) 
{ 
  register int i ;
  register int j ;
  double maxi ;
  double mini ;
  double tmp ;
  double tmp___0 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;
  char *__cil_tmp22 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;
  char *__cil_tmp25 ;
  char *__cil_tmp26 ;
  char *__cil_tmp27 ;
  {
  {
  maxi = 0.;
  mini = 0.;
  Electric_Field();
  }
  if (FARADAYFLAG) {
    {
    Faraday();
    }
  }
  if (model == 0) {
    goto _L;
  } else
  if (model == 2) {
    _L: 
    {
    EMC();
    Charge();
    }
    if ((int )(TF / DT) - (int )(TEMPO / DT) < MEDIA) {
      {
      media();
      }
    }
    if (TEMPO + DT >= TF) {
      DT = TF - TEMPO;
    }
    TEMPO += DT;
  }
  if (model == 3) {
    {
    DT /= 2.;
    ParabMEP2D(nx, ny, dx, dy, 0.475, 1.0);
    electron_relaxation_step();
    DT *= 2.;
    }
  } else
  if (model == 5) {
    {
    DT /= 2.;
    ParabMEP2D(nx, ny, dx, dy, 0.475, 1.0);
    electron_relaxation_step();
    DT *= 2.;
    }
  }
  if (model == 4) {
    {
    DT /= 2.;
    Hole_MEP2D(nx, ny, dx, dy, 0.475, 1.0);
    Relaxation_Step_Hole();
    DT *= 2.;
    }
  } else
  if (model == 5) {
    {
    DT /= 2.;
    Hole_MEP2D(nx, ny, dx, dy, 0.475, 1.0);
    Relaxation_Step_Hole();
    DT *= 2.;
    }
  }
  {
  printf((char const   */* __restrict  */)"%5d   TIME = %10.4g  (picosec)\n", c, TEMPO * 1.e12);
  }
  if (MAXIMINI == 1) {
    mini = 0.;
    maxi = mini;
    i = 1;
    {
    while (1) {
      while_continue: /* CIL Label */ ;
      if (! (i <= nx + 1)) {
        goto while_break;
      }
      j = 1;
      {
      while (1) {
        while_continue___0: /* CIL Label */ ;
        if (! (j <= ny + 1)) {
          goto while_break___0;
        }
        if (Model_Number == 0) {
          goto _L___0;
        } else
        if (Model_Number == 2) {
          _L___0: 
          if (u2d[i][j][0] >= maxi) {
            maxi = u2d[i][j][0];
          }
          if (u2d[i][j][0] <= mini) {
            mini = u2d[i][j][0];
          }
        }
        if (Model_Number == 3) {
          goto _L___1;
        } else
        if (Model_Number == 5) {
          _L___1: 
          if (u2d[i + 2][j + 2][0] >= maxi) {
            maxi = u2d[i + 2][j + 2][0];
          }
          if (u2d[i + 2][j + 2][0] <= mini) {
            mini = u2d[i + 2][j + 2][0];
          }
        }
        j ++;
      }
      while_break___8: /* CIL Label */ ;
      }
      while_break___0: 
      i ++;
    }
    while_break___7: /* CIL Label */ ;
    }
    while_break: 
    {
    printf((char const   */* __restrict  */)"Max. Potential = %g\n", maxi);
    printf((char const   */* __restrict  */)"Min. Potential = %g\n", mini);
    mini = 0.;
    maxi = mini;
    i = 1;
    }
    {
    while (1) {
      while_continue___1: /* CIL Label */ ;
      if (! (i <= nx + 1)) {
        goto while_break___1;
      }
      j = 1;
      {
      while (1) {
        while_continue___2: /* CIL Label */ ;
        if (! (j <= ny + 1)) {
          goto while_break___2;
        }
        if (E[i][j][0] >= maxi) {
          maxi = E[i][j][0];
        }
        if (E[i][j][0] <= mini) {
          mini = E[i][j][0];
        }
        j ++;
      }
      while_break___10: /* CIL Label */ ;
      }
      while_break___2: 
      i ++;
    }
    while_break___9: /* CIL Label */ ;
    }
    while_break___1: 
    {
    printf((char const   */* __restrict  */)"Max. x-elec.field = %g\n", maxi);
    printf((char const   */* __restrict  */)"Min. x-elec.field = %g\n", mini);
    mini = 0.;
    maxi = mini;
    i = 1;
    }
    {
    while (1) {
      while_continue___3: /* CIL Label */ ;
      if (! (i <= nx + 1)) {
        goto while_break___3;
      }
      j = 1;
      {
      while (1) {
        while_continue___4: /* CIL Label */ ;
        if (! (j <= ny + 1)) {
          goto while_break___4;
        }
        if (E[i][j][1] >= maxi) {
          maxi = E[i][j][1];
        }
        if (E[i][j][1] <= mini) {
          mini = E[i][j][1];
        }
        j ++;
      }
      while_break___12: /* CIL Label */ ;
      }
      while_break___4: 
      i ++;
    }
    while_break___11: /* CIL Label */ ;
    }
    while_break___3: 
    {
    printf((char const   */* __restrict  */)"Max. y-elec.field = %g\n", maxi);
    printf((char const   */* __restrict  */)"Min. y-elec.field = %g\n", mini);
    maxi = 0.;
    mini = DDmax;
    i = 1;
    }
    {
    while (1) {
      while_continue___5: /* CIL Label */ ;
      if (! (i <= nx + 1)) {
        goto while_break___5;
      }
      j = 1;
      {
      while (1) {
        while_continue___6: /* CIL Label */ ;
        if (! (j <= ny + 1)) {
          goto while_break___6;
        }
        if (Model_Number == 0) {
          goto _L___2;
        } else
        if (Model_Number == 2) {
          _L___2: 
          if (u2d[i][j][1] >= maxi) {
            maxi = u2d[i][j][1];
          }
          if (u2d[i][j][1] <= mini) {
            mini = u2d[i][j][1];
          }
        }
        if (Model_Number == 3) {
          goto _L___3;
        } else
        if (Model_Number == 5) {
          _L___3: 
          if (u2d[i + 2][j + 2][1] >= maxi) {
            maxi = u2d[i + 2][j + 2][1];
          }
          if (u2d[i + 2][j + 2][1] <= mini) {
            mini = u2d[i + 2][j + 2][1];
          }
        }
        j ++;
      }
      while_break___14: /* CIL Label */ ;
      }
      while_break___6: 
      i ++;
    }
    while_break___13: /* CIL Label */ ;
    }
    while_break___5: 
    {
    printf((char const   */* __restrict  */)"Max. Density = %g\n", maxi);
    printf((char const   */* __restrict  */)"Min. Density = %g\n", mini);
    }
  }
  if (SAVEALWAYS == 1) {
    {
    SaveOutputFiles(File_Format, c);
    printf((char const   */* __restrict  */)"Output number %d has been saved\n", c);
    }
  }
  {
  tmp = fabs(TEMPO - TF);
  tmp___0 = fabs(TF);
  }
  if (tmp / tmp___0 < 1.e-5) {
    {
    Compute_Currents();
    c = 10000010;
    }
  }
  return;
}
}
void Read_Input_File(void) 
{ 
  char s[180] ;
  double num ;
  double num0 ;
  int ini ;
  int fin ;
  int i ;
  int j ;
  int LXflag ;
  int LYflag ;
  int transportflag ;
  double tmp ;
  double tmp___0 ;
  double tmp___1 ;
  double tmp___2 ;
  int type ;
  double xi ;
  double xf ;
  double yi ;
  double yf ;
  int tmp___3 ;
  int tmp___4 ;
  double dum ;
  double dum___0 ;
  double dum___1 ;
  double dum___2 ;
  double dum___3 ;
  int tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int tmp___14 ;
  int tmp___15 ;
  int tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  int tmp___20 ;
  int tmp___21 ;
  int tmp___22 ;
  int tmp___23 ;
  int tmp___24 ;
  int tmp___25 ;
  int tmp___26 ;
  int tmp___27 ;
  int tmp___28 ;
  int tmp___29 ;
  int tmp___30 ;
  FILE *dp ;
  FILE *pp ;
  FILE *ep ;
  double dum___4 ;
  double dum0 ;
  double dum1 ;
  double xmin ;
  double ymin ;
  double xmax ;
  double ymax ;
  double conc ;
  double tmp___31 ;
  double tmp___32 ;
  double xmin___0 ;
  double ymin___0 ;
  double xmax___0 ;
  double ymax___0 ;
  double conc___0 ;
  double tmp___33 ;
  int tmp___34 ;
  int tmp___35 ;
  char pos[80] ;
  char kind[80] ;
  double ipos ;
  double fpos ;
  double delt ;
  double dens ;
  double denshole ;
  double potential ;
  int i___0 ;
  int j___0 ;
  int k ;
  int tmp___36 ;
  int tmp___37 ;
  int tmp___38 ;
  int tmp___39 ;
  int tmp___40 ;
  int tmp___41 ;
  int tmp___42 ;
  int tmp___43 ;
  int tmp___44 ;
  int tmp___45 ;
  int tmp___46 ;
  int tmp___47 ;
  int tmp___48 ;
  int tmp___49 ;
  int tmp___50 ;
  int tmp___51 ;
  double xi___0 ;
  double yi___0 ;
  double xf___0 ;
  double yf___0 ;
  double value ;
  int tmp___52 ;
  int tmp___53 ;
  int tmp___54 ;
  int tmp___55 ;
  int tmp___56 ;
  int tmp___57 ;
  int tmp___58 ;
  int tmp___59 ;
  int tmp___60 ;
  int tmp___61 ;
  int tmp___62 ;
  int tmp___63 ;
  int tmp___64 ;
  int tmp___65 ;
  int tmp___66 ;
  int tmp___67 ;
  int tmp___68 ;
  int tmp___69 ;
  int tmp___70 ;
  int tmp___71 ;
  int tmp___72 ;
  int tmp___73 ;
  int tmp___74 ;
  int tmp___75 ;
  int tmp___76 ;
  int tmp___77 ;
  int tmp___78 ;
  int tmp___79 ;
  void *__cil_tmp380 ;
  void *__cil_tmp381 ;
  void *__cil_tmp382 ;
  char *__cil_tmp383 ;
  char *__cil_tmp384 ;
  char *__cil_tmp385 ;
  char *__cil_tmp386 ;
  char *__cil_tmp387 ;
  char *__cil_tmp388 ;
  char *__cil_tmp389 ;
  char *__cil_tmp390 ;
  char *__cil_tmp391 ;
  char *__cil_tmp392 ;
  char *__cil_tmp393 ;
  char *__cil_tmp394 ;
  char *__cil_tmp395 ;
  char *__cil_tmp396 ;
  char *__cil_tmp397 ;
  char *__cil_tmp398 ;
  char *__cil_tmp399 ;
  char *__cil_tmp400 ;
  char *__cil_tmp401 ;
  char *__cil_tmp402 ;
  char *__cil_tmp403 ;
  char *__cil_tmp404 ;
  char *__cil_tmp405 ;
  char *__cil_tmp406 ;
  char *__cil_tmp407 ;
  char *__cil_tmp408 ;
  char *__cil_tmp409 ;
  char *__cil_tmp410 ;
  char *__cil_tmp411 ;
  char *__cil_tmp412 ;
  char *__cil_tmp413 ;
  char *__cil_tmp414 ;
  char *__cil_tmp415 ;
  char *__cil_tmp416 ;
  char *__cil_tmp417 ;
  char *__cil_tmp418 ;
  char *__cil_tmp419 ;
  char *__cil_tmp420 ;
  char *__cil_tmp421 ;
  char *__cil_tmp422 ;
  char *__cil_tmp423 ;
  char *__cil_tmp424 ;
  char *__cil_tmp425 ;
  char *__cil_tmp426 ;
  char *__cil_tmp427 ;
  char *__cil_tmp428 ;
  char *__cil_tmp429 ;
  char *__cil_tmp430 ;
  char *__cil_tmp431 ;
  char *__cil_tmp432 ;
  char *__cil_tmp433 ;
  char *__cil_tmp434 ;
  char *__cil_tmp435 ;
  char *__cil_tmp436 ;
  char *__cil_tmp437 ;
  char *__cil_tmp438 ;
  char *__cil_tmp439 ;
  char *__cil_tmp440 ;
  char *__cil_tmp441 ;
  char *__cil_tmp442 ;
  char *__cil_tmp443 ;
  char *__cil_tmp444 ;
  char *__cil_tmp445 ;
  char *__cil_tmp446 ;
  char *__cil_tmp447 ;
  char *__cil_tmp448 ;
  char *__cil_tmp449 ;
  char *__cil_tmp450 ;
  char *__cil_tmp451 ;
  char *__cil_tmp452 ;
  char *__cil_tmp453 ;
  char *__cil_tmp454 ;
  char *__cil_tmp455 ;
  char *__cil_tmp456 ;
  char *__cil_tmp457 ;
  char *__cil_tmp458 ;
  char *__cil_tmp459 ;
  char *__cil_tmp460 ;
  char *__cil_tmp461 ;
  char *__cil_tmp462 ;
  char *__cil_tmp463 ;
  char *__cil_tmp464 ;
  char *__cil_tmp465 ;
  char *__cil_tmp466 ;
  char *__cil_tmp467 ;
  char *__cil_tmp468 ;
  char *__cil_tmp469 ;
  char *__cil_tmp470 ;
  char *__cil_tmp471 ;
  char *__cil_tmp472 ;
  char *__cil_tmp473 ;
  char *__cil_tmp474 ;
  char *__cil_tmp475 ;
  char *__cil_tmp476 ;
  char *__cil_tmp477 ;
  char *__cil_tmp478 ;
  char *__cil_tmp479 ;
  char *__cil_tmp480 ;
  char *__cil_tmp481 ;
  char *__cil_tmp482 ;
  char *__cil_tmp483 ;
  char *__cil_tmp484 ;
  char *__cil_tmp485 ;
  char *__cil_tmp486 ;
  char *__cil_tmp487 ;
  char *__cil_tmp488 ;
  char *__cil_tmp489 ;
  char *__cil_tmp490 ;
  char *__cil_tmp491 ;
  char *__cil_tmp492 ;
  char *__cil_tmp493 ;
  char *__cil_tmp494 ;
  char *__cil_tmp495 ;
  char *__cil_tmp496 ;
  char *__cil_tmp497 ;
  char *__cil_tmp498 ;
  char *__cil_tmp499 ;
  char *__cil_tmp500 ;
  char *__cil_tmp501 ;
  char *__cil_tmp502 ;
  char *__cil_tmp503 ;
  char *__cil_tmp504 ;
  char *__cil_tmp505 ;
  char *__cil_tmp506 ;
  char *__cil_tmp507 ;
  char *__cil_tmp508 ;
  char *__cil_tmp509 ;
  char *__cil_tmp510 ;
  char *__cil_tmp511 ;
  char *__cil_tmp512 ;
  char *__cil_tmp513 ;
  char *__cil_tmp514 ;
  char *__cil_tmp515 ;
  char *__cil_tmp516 ;
  char *__cil_tmp517 ;
  char *__cil_tmp518 ;
  char *__cil_tmp519 ;
  char *__cil_tmp520 ;
  char *__cil_tmp521 ;
  char *__cil_tmp522 ;
  char *__cil_tmp523 ;
  char *__cil_tmp524 ;
  char *__cil_tmp525 ;
  char *__cil_tmp526 ;
  char *__cil_tmp527 ;
  char *__cil_tmp528 ;
  char *__cil_tmp529 ;
  char *__cil_tmp530 ;
  char *__cil_tmp531 ;
  char *__cil_tmp532 ;
  char *__cil_tmp533 ;
  char *__cil_tmp534 ;
  char *__cil_tmp535 ;
  char *__cil_tmp536 ;
  char *__cil_tmp537 ;
  char *__cil_tmp538 ;
  char *__cil_tmp539 ;
  char *__cil_tmp540 ;
  char *__cil_tmp541 ;
  char *__cil_tmp542 ;
  char *__cil_tmp543 ;
  char *__cil_tmp544 ;
  char *__cil_tmp545 ;
  char *__cil_tmp546 ;
  char *__cil_tmp547 ;
  char *__cil_tmp548 ;
  char *__cil_tmp549 ;
  char *__cil_tmp550 ;
  char *__cil_tmp551 ;
  char *__cil_tmp552 ;
  char *__cil_tmp553 ;
  char *__cil_tmp554 ;
  char *__cil_tmp555 ;
  char *__cil_tmp556 ;
  char *__cil_tmp557 ;
  char *__cil_tmp558 ;
  char *__cil_tmp559 ;
  char *__cil_tmp560 ;
  char *__cil_tmp561 ;
  char *__cil_tmp562 ;
  char *__cil_tmp563 ;
  char *__cil_tmp564 ;
  char *__cil_tmp565 ;
  char *__cil_tmp566 ;
  char *__cil_tmp567 ;
  char *__cil_tmp568 ;
  char *__cil_tmp569 ;
  char *__cil_tmp570 ;
  char *__cil_tmp571 ;
  char *__cil_tmp572 ;
  char *__cil_tmp573 ;
  char *__cil_tmp574 ;
  char *__cil_tmp575 ;
  char *__cil_tmp576 ;
  char *__cil_tmp577 ;
  char *__cil_tmp578 ;
  char *__cil_tmp579 ;
  char *__cil_tmp580 ;
  char *__cil_tmp581 ;
  char *__cil_tmp582 ;
  char *__cil_tmp583 ;
  char *__cil_tmp584 ;
  char *__cil_tmp585 ;
  char *__cil_tmp586 ;
  char *__cil_tmp587 ;
  char *__cil_tmp588 ;
  char *__cil_tmp589 ;
  char *__cil_tmp590 ;
  char *__cil_tmp591 ;
  char *__cil_tmp592 ;
  char *__cil_tmp593 ;
  char *__cil_tmp594 ;
  char *__cil_tmp595 ;
  char *__cil_tmp596 ;
  char *__cil_tmp597 ;
  char *__cil_tmp598 ;
  char *__cil_tmp599 ;
  char *__cil_tmp600 ;
  char *__cil_tmp601 ;
  char *__cil_tmp602 ;
  char *__cil_tmp603 ;
  char *__cil_tmp604 ;
  char *__cil_tmp605 ;
  char *__cil_tmp606 ;
  char *__cil_tmp607 ;
  char *__cil_tmp608 ;
  char *__cil_tmp609 ;
  char *__cil_tmp610 ;
  char *__cil_tmp611 ;
  char *__cil_tmp612 ;
  char *__cil_tmp613 ;
  char *__cil_tmp614 ;
  char *__cil_tmp615 ;
  char *__cil_tmp616 ;
  char *__cil_tmp617 ;
  char *__cil_tmp618 ;
  char *__cil_tmp619 ;
  char *__cil_tmp620 ;
  char *__cil_tmp621 ;
  char *__cil_tmp622 ;
  char *__cil_tmp623 ;
  char *__cil_tmp624 ;
  char *__cil_tmp625 ;
  {
  LXflag = 0;
  LYflag = 0;
  transportflag = 0;
  XVAL[15] = 0.5;
  XVAL[14] = XVAL[15];
  XVAL[13] = XVAL[14];
  XVAL[6] = XVAL[13];
  XVAL[5] = XVAL[6];
  Model_Number = 0;
  nx = 50;
  ny = 50;
  TF = 5.0e-12;
  DT = 0.001e-12;
  TAUW = 0.4e-12;
  msh = (double )mstarHSILICON;
  FARADAYFLAG = 0;
  i = 1;
  {
  while (1) {
    while_continue: /* CIL Label */ ;
    if (! (i <= nx + 1)) {
      goto while_break;
    }
    j = 1;
    {
    while (1) {
      while_continue___0: /* CIL Label */ ;
      if (! (j <= ny + 1)) {
        goto while_break___0;
      }
      tmp = (double )NI;
      N_D[i][j] = tmp;
      u2d[i][j][1] = tmp;
      tmp___0 = (double )NI;
      N_H[i][j] = tmp___0;
      h2d[i][j][1] = tmp___0;
      tmp___1 = 0.;
      u2d[i][j][3] = tmp___1;
      u2d[i][j][2] = tmp___1;
      tmp___2 = 0.;
      h2d[i][j][3] = tmp___2;
      h2d[i][j][2] = tmp___2;
      i_dom[i][j] = 0;
      B[i][j] = 0.;
      j ++;
    }
    while_break___20: /* CIL Label */ ;
    }
    while_break___0: 
    i ++;
  }
  while_break___19: /* CIL Label */ ;
  }
  while_break: 
  {
  CIMP = 1.e20;
  TL = 300.;
  NP1 = 2500;
  MEDIA = 500;
  Quantum_Flag = 0;
  MAXIMINI = 0;
  SAVEALWAYS = 0;
  File_Format = 0;
  leid_flag = 0;
  SIO2_UP_FLAG = 0;
  SIO2_DOWN_FLAG = 0;
  printf((char const   */* __restrict  */)"Processing the input file\n=========================\n");
  }
  {
  while (1) {
    while_continue___1: /* CIL Label */ ;
    {
    fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s", s);
    tmp___78 = strcmp((char const   *)(s), "#");
    }
    if (tmp___78 == 0) {
      {
      fgets((char */* __restrict  */)(s), 80, (FILE */* __restrict  */)fp);
      printf((char const   */* __restrict  */)"COMMENT ---> %s", s);
      }
    } else {
      {
      tmp___77 = strcmp((char const   *)(s), "MATERIAL");
      }
      if (tmp___77 == 0) {
        {
        fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s",
               s);
        tmp___3 = strcmp((char const   *)(s), "X");
        }
        if (tmp___3 == 0) {
          {
          fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf %lf",
                 & xi, & xf);
          }
        } else {
          {
          printf((char const   */* __restrict  */)"%s : X material not specified!\n",
                 progname);
          exit(0);
          }
        }
        {
        fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s",
               s);
        tmp___4 = strcmp((char const   *)(s), "Y");
        }
        if (tmp___4 == 0) {
          {
          fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf %lf",
                 & yi, & yf);
          }
        } else {
          {
          printf((char const   */* __restrict  */)"%s : Y material not specified!\n",
                 progname);
          exit(0);
          }
        }
        {
        fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s",
               s);
        tmp___20 = strcmp((char const   *)(s), "SILICON");
        }
        if (tmp___20 == 0) {
          type = 0;
          msh = (double )mstarHSILICON;
        } else {
          {
          tmp___19 = strcmp((char const   *)(s), "GAAS");
          }
          if (tmp___19 == 0) {
            type = 1;
            msh = (double )mstarHGAAS;
          } else {
            {
            tmp___18 = strcmp((char const   *)(s), "GERMANIUM");
            }
            if (tmp___18 == 0) {
              type = 2;
              msh = (double )mstarHGERMANIUM;
            } else {
              {
              tmp___17 = strcmp((char const   *)(s), "INSB");
              }
              if (tmp___17 == 0) {
                type = 3;
              } else {
                {
                tmp___16 = strcmp((char const   *)(s), "ALSB");
                }
                if (tmp___16 == 0) {
                  type = 4;
                } else {
                  {
                  tmp___15 = strcmp((char const   *)(s), "ALAS");
                  }
                  if (tmp___15 == 0) {
                    type = 7;
                  } else {
                    {
                    tmp___14 = strcmp((char const   *)(s), "ALP");
                    }
                    if (tmp___14 == 0) {
                      type = 8;
                    } else {
                      {
                      tmp___13 = strcmp((char const   *)(s), "GAP");
                      }
                      if (tmp___13 == 0) {
                        type = 9;
                      } else {
                        {
                        tmp___12 = strcmp((char const   *)(s), "GASB");
                        }
                        if (tmp___12 == 0) {
                          type = 10;
                        } else {
                          {
                          tmp___11 = strcmp((char const   *)(s), "INAS");
                          }
                          if (tmp___11 == 0) {
                            type = 11;
                          } else {
                            {
                            tmp___10 = strcmp((char const   *)(s), "INP");
                            }
                            if (tmp___10 == 0) {
                              type = 12;
                            } else {
                              {
                              tmp___9 = strcmp((char const   *)(s), "ALxINxSB");
                              }
                              if (tmp___9 == 0) {
                                {
                                type = 5;
                                fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                       & dum);
                                XVAL[type] = dum;
                                }
                                if (XVAL[type] < 0.) {
                                  {
                                  printf((char const   */* __restrict  */)"%s : x negative for AlxInxSb!\n",
                                         progname);
                                  exit(0);
                                  }
                                }
                                {
                                XVAL[type] = dum;
                                printf((char const   */* __restrict  */)"AlxInxSb X = %g\n",
                                       XVAL[type]);
                                }
                              } else {
                                {
                                tmp___8 = strcmp((char const   *)(s), "ALxIN1-xSB");
                                }
                                if (tmp___8 == 0) {
                                  {
                                  type = 6;
                                  fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                         & dum___0);
                                  XVAL[type] = dum___0;
                                  }
                                  if (XVAL[type] < 0.) {
                                    {
                                    printf((char const   */* __restrict  */)"%s : x negative for AlxIn(1-x)Sb!\n",
                                           progname);
                                    exit(0);
                                    }
                                  }
                                  {
                                  XVAL[type] = dum___0;
                                  printf((char const   */* __restrict  */)"AlxIn(1-x)Sb X = %g\n",
                                         XVAL[type]);
                                  }
                                } else {
                                  {
                                  tmp___7 = strcmp((char const   *)(s), "INxGA1-xAS");
                                  }
                                  if (tmp___7 == 0) {
                                    {
                                    type = 13;
                                    fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                           & dum___1);
                                    XVAL[type] = dum___1;
                                    }
                                    if (XVAL[type] < 0.) {
                                      {
                                      printf((char const   */* __restrict  */)"%s : x negative for InxGa(1-x)As!\n",
                                             progname);
                                      exit(0);
                                      }
                                    }
                                    {
                                    XVAL[type] = dum___1;
                                    printf((char const   */* __restrict  */)"InxGa(1-x)As X = %g\n",
                                           XVAL[type]);
                                    }
                                  } else {
                                    {
                                    tmp___6 = strcmp((char const   *)(s), "INxAL1-xAS");
                                    }
                                    if (tmp___6 == 0) {
                                      {
                                      type = 14;
                                      fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                             & dum___2);
                                      XVAL[type] = dum___2;
                                      }
                                      if (XVAL[type] < 0.) {
                                        {
                                        printf((char const   */* __restrict  */)"%s : x negative for InxAl(1-x)As!\n",
                                               progname);
                                        exit(0);
                                        }
                                      }
                                      {
                                      XVAL[type] = dum___2;
                                      printf((char const   */* __restrict  */)"InxAl(1-x)As X = %g\n",
                                             XVAL[type]);
                                      }
                                    } else {
                                      {
                                      tmp___5 = strcmp((char const   *)(s), "INxGAxAS2");
                                      }
                                      if (tmp___5 == 0) {
                                        {
                                        type = 15;
                                        fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                               & dum___3);
                                        XVAL[type] = dum___3;
                                        }
                                        if (XVAL[type] < 0.) {
                                          {
                                          printf((char const   */* __restrict  */)"%s : x negative for InxGaxAs2!\n",
                                                 progname);
                                          exit(0);
                                          }
                                        }
                                        {
                                        XVAL[type] = dum___3;
                                        printf((char const   */* __restrict  */)"InxGaxAs2 X = %g\n",
                                               XVAL[type]);
                                        }
                                      } else {
                                        {
                                        printf((char const   */* __restrict  */)"%s : unknown specified material!\n",
                                               progname);
                                        exit(0);
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
        i = 0;
        {
        while (1) {
          while_continue___2: /* CIL Label */ ;
          if (! (i <= nx + 4)) {
            goto while_break___2;
          }
          j = 0;
          {
          while (1) {
            while_continue___3: /* CIL Label */ ;
            if (! (j <= ny + 4)) {
              goto while_break___3;
            }
            if (((double )i - 0.5) * dx >= xi) {
              if (((double )i - 1.5) * dx <= xf) {
                if (((double )j - 0.5) * dy >= yi) {
                  if (((double )j - 1.5) * dy <= yf) {
                    i_dom[i][j] = type;
                  }
                }
              }
            }
            j ++;
          }
          while_break___23: /* CIL Label */ ;
          }
          while_break___3: 
          i ++;
        }
        while_break___22: /* CIL Label */ ;
        }
        while_break___2: 
        {
        printf((char const   */* __restrict  */)"MATERIAL %s X=[%g,%g] Y=[%g,%g] ---> Ok\n",
               s, xi, xf, yi, yf);
        }
      } else {
        {
        tmp___76 = strcmp((char const   *)(s), "TRANSPORT");
        }
        if (tmp___76 == 0) {
          {
          transportflag = 1;
          fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s",
                 s);
          tmp___28 = strcmp((char const   *)(s), "MC");
          }
          if (tmp___28 == 0) {
            {
            fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s",
                   s);
            tmp___23 = strcmp((char const   *)(s), "ELECTRONS");
            }
            if (tmp___23 == 0) {
              {
              Model_Number = 0;
              printf((char const   */* __restrict  */)"TRANSPORT MC %s ---> Ok\n",
                     s);
              }
            } else {
              {
              tmp___22 = strcmp((char const   *)(s), "HOLES");
              }
              if (tmp___22 == 0) {
                {
                Model_Number = 1;
                printf((char const   */* __restrict  */)"TRANSPORT %s ---> Ok\n",
                       s);
                printf((char const   */* __restrict  */)"%s: hole transport not yet implemented\n",
                       progname);
                exit(1);
                }
              } else {
                {
                tmp___21 = strcmp((char const   *)(s), "BIPOLAR");
                }
                if (tmp___21 == 0) {
                  {
                  Model_Number = 2;
                  printf((char const   */* __restrict  */)"TRANSPORT MC %s ---> Ok\n",
                         s);
                  }
                } else {
                  {
                  printf((char const   */* __restrict  */)"%s: unknown particles in MC transport specification\n",
                         progname);
                  exit(1);
                  }
                }
              }
            }
          } else {
            {
            tmp___27 = strcmp((char const   *)(s), "MEP");
            }
            if (tmp___27 == 0) {
              {
              fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s",
                     s);
              tmp___26 = strcmp((char const   *)(s), "ELECTRONS");
              }
              if (tmp___26 == 0) {
                {
                Model_Number = 3;
                printf((char const   */* __restrict  */)"TRANSPORT MEP %s ---> Ok\n",
                       s);
                }
              } else {
                {
                tmp___25 = strcmp((char const   *)(s), "HOLES");
                }
                if (tmp___25 == 0) {
                  {
                  Model_Number = 4;
                  printf((char const   */* __restrict  */)"TRANSPORT %s ---> Ok\n",
                         s);
                  }
                } else {
                  {
                  tmp___24 = strcmp((char const   *)(s), "BIPOLAR");
                  }
                  if (tmp___24 == 0) {
                    {
                    Model_Number = 5;
                    printf((char const   */* __restrict  */)"TRANSPORT %s ---> Ok\n",
                           s);
                    }
                  } else {
                    {
                    printf((char const   */* __restrict  */)"%s: unknown particles in MEP transport specification\n",
                           progname);
                    exit(1);
                    }
                  }
                }
              }
            } else {
              {
              printf((char const   */* __restrict  */)"%s: unknown transport model specified\n",
                     progname);
              exit(1);
              }
            }
          }
        } else {
          {
          tmp___75 = strcmp((char const   *)(s), "XSPATIALSTEP");
          }
          if (tmp___75 == 0) {
            {
            fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                   & num);
            nx = (int )num;
            }
            if (nx > 308) {
              {
              printf((char const   */* __restrict  */)"%s: too large x-spatial step\n",
                     progname);
              exit(1);
              }
            }
            if (LXflag == 0) {
              {
              printf((char const   */* __restrict  */)"%s: you have to define the x-length first\n",
                     progname);
              exit(1);
              }
            }
            {
            dx = LX / (double )nx;
            printf((char const   */* __restrict  */)"XSPATIALSTEP = %d ---> Ok\n",
                   nx);
            }
          } else {
            {
            tmp___74 = strcmp((char const   *)(s), "YSPATIALSTEP");
            }
            if (tmp___74 == 0) {
              {
              fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                     & num);
              ny = (int )num;
              }
              if (ny > 308) {
                {
                printf((char const   */* __restrict  */)"%s: too large y-spatial step\n",
                       progname);
                exit(1);
                }
              }
              if (LYflag == 0) {
                {
                printf((char const   */* __restrict  */)"%s: you have to define the y-length first\n",
                       progname);
                exit(1);
                }
              }
              {
              dy = LY / (double )ny;
              printf((char const   */* __restrict  */)"YSPATIALSTEP = %d ---> Ok\n",
                     ny);
              }
            } else {
              {
              tmp___73 = strcmp((char const   *)(s), "FINALTIME");
              }
              if (tmp___73 == 0) {
                {
                fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lg",
                       & num);
                TF = num;
                }
                if (TF <= 0.) {
                  {
                  printf((char const   */* __restrict  */)"%s: not valid final time\n",
                         progname);
                  }
                }
                {
                printf((char const   */* __restrict  */)"FINAL TIME = %lg ---> Ok\n",
                       TF);
                }
              } else {
                {
                tmp___72 = strcmp((char const   *)(s), "OXYDE");
                }
                if (tmp___72 == 0) {
                  {
                  fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s",
                         s);
                  tmp___30 = strcmp((char const   *)(s), "UP");
                  }
                  if (tmp___30 == 0) {
                    {
                    SIO2_UP_FLAG = 1;
                    fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                           & num);
                    SIO2_INI[0] = num;
                    }
                    if (num < 0.) {
                      {
                      printf((char const   */* __restrict  */)"%s: not valid upper SiO2 initial position\n",
                             progname);
                      exit(1);
                      }
                    }
                    {
                    fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                           & num);
                    SIO2_FIN[0] = num;
                    }
                    if (num <= SIO2_INI[0]) {
                      {
                      printf((char const   */* __restrict  */)"%s: not valid upper SiO2 final position\n",
                             progname);
                      exit(1);
                      }
                    } else
                    if (num > LX) {
                      {
                      printf((char const   */* __restrict  */)"%s: not valid upper SiO2 final position\n",
                             progname);
                      exit(1);
                      }
                    }
                    {
                    fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                           & num);
                    }
                    if (num <= 0.) {
                      {
                      printf((char const   */* __restrict  */)"%s: not valid upper SiO2 thickness\n",
                             progname);
                      exit(1);
                      }
                    }
                    {
                    SIO2_THICKNESS[0] = num;
                    fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                           & num);
                    SIO2_POT[0] = num;
                    printf((char const   */* __restrict  */)"OXYDE ---> UP %g %g %g %g\n",
                           SIO2_INI[0], SIO2_FIN[0], SIO2_THICKNESS[0], SIO2_POT[0]);
                    }
                  } else {
                    {
                    tmp___29 = strcmp((char const   *)(s), "DOWN");
                    }
                    if (tmp___29 == 0) {
                      {
                      SIO2_DOWN_FLAG = 1;
                      fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                             & num);
                      SIO2_INI[1] = num;
                      }
                      if (num < 0.) {
                        {
                        printf((char const   */* __restrict  */)"%s: not valid lower SiO2 initial position\n",
                               progname);
                        exit(1);
                        }
                      }
                      {
                      fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                             & num);
                      SIO2_FIN[1] = num;
                      }
                      if (num <= SIO2_INI[1]) {
                        {
                        printf((char const   */* __restrict  */)"%s: not valid lower SiO2 final position\n",
                               progname);
                        exit(1);
                        }
                      } else
                      if (num > LX) {
                        {
                        printf((char const   */* __restrict  */)"%s: not valid lower SiO2 final position\n",
                               progname);
                        exit(1);
                        }
                      }
                      {
                      fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                             & num);
                      }
                      if (num <= 0.) {
                        {
                        printf((char const   */* __restrict  */)"%s: not valid lower SiO2 thickness\n",
                               progname);
                        exit(1);
                        }
                      }
                      {
                      SIO2_THICKNESS[1] = num;
                      fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                             & num);
                      SIO2_POT[1] = num;
                      printf((char const   */* __restrict  */)"OXYDE ---> DOWN %g %g %g %g\n",
                             SIO2_INI[1], SIO2_FIN[1], SIO2_THICKNESS[1], SIO2_POT[1]);
                      }
                    } else {
                      {
                      printf((char const   */* __restrict  */)"%s: not valid final time\n",
                             progname);
                      exit(1);
                      }
                    }
                  }
                  {
                  printf((char const   */* __restrict  */)"FINAL TIME = %g ---> Ok\n",
                         TF);
                  }
                } else {
                  {
                  tmp___71 = strcmp((char const   *)(s), "TAUW");
                  }
                  if (tmp___71 == 0) {
                    {
                    fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                           & num);
                    TAUW = num;
                    }
                    if (TAUW == 0.) {
                      {
                      printf((char const   */* __restrict  */)"%s: not valid energy relaxation time\n",
                             progname);
                      exit(1);
                      }
                    }
                    {
                    printf((char const   */* __restrict  */)"TAUW = %g ---> Ok\n",
                           TAUW);
                    }
                  } else {
                    {
                    tmp___70 = strcmp((char const   *)(s), "TIMESTEP");
                    }
                    if (tmp___70 == 0) {
                      {
                      fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                             & num);
                      DT = num;
                      }
                      if (DT <= 0.) {
                        {
                        printf((char const   */* __restrict  */)"%s: not valid time step\n",
                               progname);
                        exit(1);
                        }
                      }
                      {
                      printf((char const   */* __restrict  */)"TIME STEP = %g ---> Ok\n",
                             DT);
                      }
                    } else {
                      {
                      tmp___69 = strcmp((char const   *)(s), "LEID");
                      }
                      if (tmp___69 == 0) {
                        {
                        dp = fopen((char const   */* __restrict  */)"density_start.xyz",
                                   (char const   */* __restrict  */)"r");
                        }
                        if ((unsigned long )dp == (unsigned long )((void *)0)) {
                          {
                          printf((char const   */* __restrict  */)"%s: fatal error in opening the density000.xyz input file\n",
                                 progname);
                          exit(1);
                          }
                        }
                        {
                        ep = fopen((char const   */* __restrict  */)"energy_start.xyz",
                                   (char const   */* __restrict  */)"r");
                        }
                        if ((unsigned long )ep == (unsigned long )((void *)0)) {
                          {
                          printf((char const   */* __restrict  */)"%s: fatal error in opening the energy000.xyz input file\n",
                                 progname);
                          exit(1);
                          }
                        }
                        {
                        pp = fopen((char const   */* __restrict  */)"potential_start.xyz",
                                   (char const   */* __restrict  */)"r");
                        }
                        if ((unsigned long )pp == (unsigned long )((void *)0)) {
                          {
                          printf((char const   */* __restrict  */)"%s: fatal error in opening the potential000.xyz input file\n",
                                 progname);
                          exit(1);
                          }
                        }
                        if (Model_Number == 0) {
                          goto _L;
                        } else
                        if (Model_Number == 2) {
                          _L: 
                          j = 1;
                          {
                          while (1) {
                            while_continue___4: /* CIL Label */ ;
                            if (! (j <= ny + 1)) {
                              goto while_break___4;
                            }
                            i = 1;
                            {
                            while (1) {
                              while_continue___5: /* CIL Label */ ;
                              if (! (i <= nx + 1)) {
                                goto while_break___5;
                              }
                              {
                              fscanf((FILE */* __restrict  */)dp, (char const   */* __restrict  */)"%lf %lf %lf",
                                     & dum0, & dum1, & dum___4);
                              u2d[i][j][1] = dum___4;
                              fscanf((FILE */* __restrict  */)ep, (char const   */* __restrict  */)"%lf %lf %lf",
                                     & dum0, & dum1, & dum___4);
                              u2d[i][j][4] = (dum___4 * (double )Q) * u2d[i][j][1];
                              fscanf((FILE */* __restrict  */)pp, (char const   */* __restrict  */)"%lf %lf %lf",
                                     & dum0, & dum1, & dum___4);
                              PSI[i][j] = dum___4;
                              i ++;
                              }
                            }
                            while_break___25: /* CIL Label */ ;
                            }
                            while_break___5: 
                            j ++;
                          }
                          while_break___24: /* CIL Label */ ;
                          }
                          while_break___4: ;
                        }
                        if (Model_Number == 3) {
                          goto _L___0;
                        } else
                        if (Model_Number == 5) {
                          _L___0: 
                          j = 1;
                          {
                          while (1) {
                            while_continue___6: /* CIL Label */ ;
                            if (! (j <= ny + 1)) {
                              goto while_break___6;
                            }
                            i = 1;
                            {
                            while (1) {
                              while_continue___7: /* CIL Label */ ;
                              if (! (i <= nx + 1)) {
                                goto while_break___7;
                              }
                              {
                              fscanf((FILE */* __restrict  */)dp, (char const   */* __restrict  */)"%lf %lf %lf",
                                     & dum0, & dum1, & dum___4);
                              u2d[i + 2][j + 2][1] = dum___4;
                              fscanf((FILE */* __restrict  */)ep, (char const   */* __restrict  */)"%lf %lf %lf",
                                     & dum0, & dum1, & dum___4);
                              u2d[i + 2][j + 2][4] = (dum___4 * (double )Q) * u2d[i + 2][j + 2][1];
                              fscanf((FILE */* __restrict  */)pp, (char const   */* __restrict  */)"%lf %lf %lf",
                                     & dum0, & dum1, & dum___4);
                              PSI[i][j] = dum___4;
                              i ++;
                              }
                            }
                            while_break___27: /* CIL Label */ ;
                            }
                            while_break___7: 
                            j ++;
                          }
                          while_break___26: /* CIL Label */ ;
                          }
                          while_break___6: ;
                        }
                        {
                        fclose(dp);
                        fclose(ep);
                        fclose(pp);
                        leid_flag = 1;
                        printf((char const   */* __restrict  */)"Electron initial data loaded ---> Ok\n");
                        }
                      } else {
                        {
                        tmp___68 = strcmp((char const   *)(s), "CIMP");
                        }
                        if (tmp___68 == 0) {
                          {
                          fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                 & num);
                          CIMP = num;
                          }
                          if (CIMP < 0.) {
                            {
                            printf((char const   */* __restrict  */)"%s: not valid impurity concentration\n",
                                   progname);
                            exit(1);
                            }
                          }
                          {
                          printf((char const   */* __restrict  */)"CIMP = %g ---> Ok\n",
                                 CIMP);
                          }
                        } else {
                          {
                          tmp___67 = strcmp((char const   *)(s), "XLENGTH");
                          }
                          if (tmp___67 == 0) {
                            {
                            fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                   & num);
                            LX = num;
                            }
                            if (LX <= 0.) {
                              {
                              printf((char const   */* __restrict  */)"%s: not valid x-length\n",
                                     progname);
                              exit(1);
                              }
                            }
                            {
                            LXflag = 1;
                            printf((char const   */* __restrict  */)"LENGTH X = %g ---> Ok\n",
                                   LX);
                            }
                          } else {
                            {
                            tmp___66 = strcmp((char const   *)(s), "YLENGTH");
                            }
                            if (tmp___66 == 0) {
                              {
                              fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                     & num);
                              LY = num;
                              }
                              if (LY <= 0.) {
                                {
                                printf((char const   */* __restrict  */)"%s: not valid y-length\n",
                                       progname);
                                exit(1);
                                }
                              }
                              {
                              LYflag = 1;
                              printf((char const   */* __restrict  */)"LENGTH Y = %g ---> Ok\n",
                                     LY);
                              }
                            } else {
                              {
                              tmp___65 = strcmp((char const   *)(s), "DONORDENSITY");
                              }
                              if (tmp___65 == 0) {
                                if (transportflag == 0) {
                                  {
                                  printf((char const   */* __restrict  */)"%s: you have to specify a transport model first\n",
                                         progname);
                                  exit(1);
                                  }
                                }
                                {
                                fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                       & num);
                                xmin = num;
                                }
                                if (xmin < 0.) {
                                  {
                                  printf((char const   */* __restrict  */)"%s: not valid xmin value\n",
                                         progname);
                                  exit(1);
                                  }
                                }
                                {
                                fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                       & num);
                                ymin = num;
                                }
                                if (ymin < 0.) {
                                  {
                                  printf((char const   */* __restrict  */)"%s: not valid ymin value\n",
                                         progname);
                                  exit(1);
                                  }
                                }
                                {
                                fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                       & num);
                                xmax = num;
                                }
                                if (xmax > LX) {
                                  {
                                  printf((char const   */* __restrict  */)"%s: not valid xmax value\n",
                                         progname);
                                  exit(1);
                                  }
                                }
                                {
                                fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                       & num);
                                ymax = num;
                                }
                                if (ymax > LY) {
                                  {
                                  printf((char const   */* __restrict  */)"%s: not valid xmin value\n",
                                         progname);
                                  exit(1);
                                  }
                                }
                                {
                                fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                       & num);
                                conc = num;
                                }
                                if (conc < 0.) {
                                  {
                                  printf((char const   */* __restrict  */)"%s: not valid donor density\n",
                                         progname);
                                  exit(1);
                                  }
                                }
                                if (Model_Number == 0) {
                                  goto _L___1;
                                } else
                                if (Model_Number == 2) {
                                  _L___1: 
                                  i = 1;
                                  {
                                  while (1) {
                                    while_continue___8: /* CIL Label */ ;
                                    if (! (i <= nx + 1)) {
                                      goto while_break___8;
                                    }
                                    j = 1;
                                    {
                                    while (1) {
                                      while_continue___9: /* CIL Label */ ;
                                      if (! (j <= ny + 1)) {
                                        goto while_break___9;
                                      }
                                      if (((double )i - 0.5) * dx >= xmin) {
                                        if (((double )i - 1.5) * dx <= xmax) {
                                          if (((double )j - 0.5) * dy >= ymin) {
                                            if (((double )j - 1.5) * dy <= ymax) {
                                              tmp___31 = conc;
                                              N_D[i][j] = tmp___31;
                                              u2d[i][j][1] = tmp___31;
                                            }
                                          }
                                        }
                                      }
                                      j ++;
                                    }
                                    while_break___29: /* CIL Label */ ;
                                    }
                                    while_break___9: 
                                    i ++;
                                  }
                                  while_break___28: /* CIL Label */ ;
                                  }
                                  while_break___8: ;
                                }
                                if (Model_Number == 3) {
                                  goto _L___2;
                                } else
                                if (Model_Number == 5) {
                                  goto _L___2;
                                } else
                                if (Model_Number == 4) {
                                  _L___2: 
                                  i = 1;
                                  {
                                  while (1) {
                                    while_continue___10: /* CIL Label */ ;
                                    if (! (i <= nx + 1)) {
                                      goto while_break___10;
                                    }
                                    j = 1;
                                    {
                                    while (1) {
                                      while_continue___11: /* CIL Label */ ;
                                      if (! (j <= ny + 1)) {
                                        goto while_break___11;
                                      }
                                      if (((double )i - 0.5) * dx >= xmin) {
                                        if (((double )i - 1.5) * dx <= xmax) {
                                          if (((double )j - 0.5) * dy >= ymin) {
                                            if (((double )j - 1.5) * dy <= ymax) {
                                              tmp___32 = conc;
                                              N_D[i][j] = tmp___32;
                                              u2d[i + 2][j + 2][1] = tmp___32;
                                              u2d[i + 2][j + 2][4] = ((conc * 1.5) * (double )KB) * TL;
                                            }
                                          }
                                        }
                                      }
                                      j ++;
                                    }
                                    while_break___31: /* CIL Label */ ;
                                    }
                                    while_break___11: 
                                    i ++;
                                  }
                                  while_break___30: /* CIL Label */ ;
                                  }
                                  while_break___10: ;
                                }
                                {
                                printf((char const   */* __restrict  */)"DONOR DENSITY %g %g %g %g %g ---> Ok\n",
                                       xmin, ymin, xmax, ymax, conc);
                                }
                              } else {
                                {
                                tmp___64 = strcmp((char const   *)(s), "ACCEPTORDENSITY");
                                }
                                if (tmp___64 == 0) {
                                  {
                                  fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                         & num);
                                  xmin___0 = num;
                                  }
                                  if (xmin___0 < 0.) {
                                    {
                                    printf((char const   */* __restrict  */)"%s: not valid xmin value\n",
                                           progname);
                                    exit(1);
                                    }
                                  }
                                  {
                                  fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                         & num);
                                  ymin___0 = num;
                                  }
                                  if (ymin___0 < 0.) {
                                    {
                                    printf((char const   */* __restrict  */)"%s: not valid ymin value\n",
                                           progname);
                                    exit(1);
                                    }
                                  }
                                  {
                                  fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                         & num);
                                  xmax___0 = num;
                                  }
                                  if (xmax___0 > LX) {
                                    {
                                    printf((char const   */* __restrict  */)"%s: not valid xmax value\n",
                                           progname);
                                    exit(1);
                                    }
                                  }
                                  {
                                  fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                         & num);
                                  ymax___0 = num;
                                  }
                                  if (ymax___0 > LY) {
                                    {
                                    printf((char const   */* __restrict  */)"%s: not valid xmin value\n",
                                           progname);
                                    exit(1);
                                    }
                                  }
                                  {
                                  fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                         & num);
                                  conc___0 = num;
                                  }
                                  if (conc___0 < 0.) {
                                    {
                                    printf((char const   */* __restrict  */)"%s: not valid acceptor density\n",
                                           progname);
                                    exit(1);
                                    }
                                  }
                                  if (Model_Number == 5) {
                                    goto _L___3;
                                  } else
                                  if (Model_Number == 4) {
                                    goto _L___3;
                                  } else
                                  if (Model_Number == 2) {
                                    _L___3: 
                                    i = 1;
                                    {
                                    while (1) {
                                      while_continue___12: /* CIL Label */ ;
                                      if (! (i <= nx + 1)) {
                                        goto while_break___12;
                                      }
                                      j = 1;
                                      {
                                      while (1) {
                                        while_continue___13: /* CIL Label */ ;
                                        if (! (j <= ny + 1)) {
                                          goto while_break___13;
                                        }
                                        if (((double )i - 0.5) * dx >= xmin___0) {
                                          if (((double )i - 1.5) * dx <= xmax___0) {
                                            if (((double )j - 0.5) * dy >= ymin___0) {
                                              if (((double )j - 1.5) * dy <= ymax___0) {
                                                tmp___33 = conc___0;
                                                N_H[i][j] = tmp___33;
                                                h2d[i + 2][j + 2][1] = tmp___33;
                                                h2d[i + 2][j + 2][4] = ((conc___0 * 1.5) * (double )KB) * TL;
                                              }
                                            }
                                          }
                                        }
                                        j ++;
                                      }
                                      while_break___33: /* CIL Label */ ;
                                      }
                                      while_break___13: 
                                      i ++;
                                    }
                                    while_break___32: /* CIL Label */ ;
                                    }
                                    while_break___12: ;
                                  }
                                } else {
                                  {
                                  tmp___63 = strcmp((char const   *)(s), "LATTICETEMPERATURE");
                                  }
                                  if (tmp___63 == 0) {
                                    {
                                    fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                           & num);
                                    TL = num;
                                    }
                                    if (TL <= 0.) {
                                      {
                                      printf((char const   */* __restrict  */)"%s: not valid lattice temperature\n",
                                             progname);
                                      exit(1);
                                      }
                                    }
                                    {
                                    printf((char const   */* __restrict  */)"LATTICE TEMPERATURE = %g ---> Ok\n",
                                           TL);
                                    }
                                  } else {
                                    {
                                    tmp___62 = strcmp((char const   *)(s), "STATISTICALWEIGHT");
                                    }
                                    if (tmp___62 == 0) {
                                      {
                                      fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                             & num);
                                      NP1 = (int )num;
                                      printf((char const   */* __restrict  */)"STATISTICAL WEIGHT = %d ---> Ok\n",
                                             NP1);
                                      }
                                    } else {
                                      {
                                      tmp___61 = strcmp((char const   *)(s), "OUTPUTFORMAT");
                                      }
                                      if (tmp___61 == 0) {
                                        {
                                        fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s",
                                               s);
                                        tmp___35 = strcmp((char const   *)(s), "GNUPLOT");
                                        }
                                        if (tmp___35 == 0) {
                                          {
                                          File_Format = 0;
                                          printf((char const   */* __restrict  */)"OUTPUT FORMAT = GNUPLOT/XD3D\n");
                                          }
                                        } else {
                                          {
                                          tmp___34 = strcmp((char const   *)(s), "MESH");
                                          }
                                          if (tmp___34 == 0) {
                                            {
                                            File_Format = 1;
                                            printf((char const   */* __restrict  */)"OUTPUT FORMAT = MESH/BB\n");
                                            }
                                          } else {
                                            {
                                            printf((char const   */* __restrict  */)"%s: unknown output format\n",
                                                   progname);
                                            exit(1);
                                            }
                                          }
                                        }
                                      } else {
                                        {
                                        tmp___60 = strcmp((char const   *)(s), "CONTACT");
                                        }
                                        if (tmp___60 == 0) {
                                          {
                                          fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s",
                                                 pos);
                                          tmp___36 = strcmp((char const   *)(pos),
                                                            "UP");
                                          }
                                          if (tmp___36 != 0) {
                                            {
                                            tmp___37 = strcmp((char const   *)(pos),
                                                              "DOWN");
                                            }
                                            if (tmp___37 != 0) {
                                              {
                                              tmp___38 = strcmp((char const   *)(pos),
                                                                "LEFT");
                                              }
                                              if (tmp___38 != 0) {
                                                {
                                                tmp___39 = strcmp((char const   *)(pos),
                                                                  "RIGHT");
                                                }
                                                if (tmp___39 != 0) {
                                                  {
                                                  printf((char const   */* __restrict  */)"%s: unknown position of contact\n",
                                                         progname);
                                                  exit(1);
                                                  }
                                                }
                                              }
                                            }
                                          }
                                          {
                                          tmp___40 = strcmp((char const   *)(pos),
                                                            "DOWN");
                                          }
                                          if (tmp___40 == 0) {
                                            i___0 = 0;
                                            delt = LX / (double )nx;
                                          }
                                          {
                                          tmp___41 = strcmp((char const   *)(pos),
                                                            "RIGHT");
                                          }
                                          if (tmp___41 == 0) {
                                            i___0 = 1;
                                            delt = LY / (double )ny;
                                          }
                                          {
                                          tmp___42 = strcmp((char const   *)(pos),
                                                            "UP");
                                          }
                                          if (tmp___42 == 0) {
                                            i___0 = 2;
                                            delt = LX / (double )nx;
                                          }
                                          {
                                          tmp___43 = strcmp((char const   *)(pos),
                                                            "LEFT");
                                          }
                                          if (tmp___43 == 0) {
                                            i___0 = 3;
                                            delt = LY / (double )ny;
                                          }
                                          {
                                          fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf %lf",
                                                 & num0, & num);
                                          ipos = num0;
                                          fpos = num;
                                          }
                                          if (ipos >= fpos) {
                                            {
                                            printf((char const   */* __restrict  */)"%s: not valid position of contact\n",
                                                   progname);
                                            exit(1);
                                            }
                                          }
                                          {
                                          fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%s",
                                                 kind);
                                          tmp___44 = strcmp((char const   *)(kind),
                                                            "INSULATOR");
                                          }
                                          if (tmp___44 != 0) {
                                            {
                                            tmp___45 = strcmp((char const   *)(kind),
                                                              "SCHOTTKY");
                                            }
                                            if (tmp___45 != 0) {
                                              {
                                              tmp___46 = strcmp((char const   *)(kind),
                                                                "OHMIC");
                                              }
                                              if (tmp___46 != 0) {
                                                {
                                                printf((char const   */* __restrict  */)"%s: specified physical contact unknown\n",
                                                       progname);
                                                exit(1);
                                                }
                                              }
                                            }
                                          }
                                          {
                                          tmp___47 = strcmp((char const   *)(kind),
                                                            "INSULATOR");
                                          }
                                          if (tmp___47 == 0) {
                                            k = 0;
                                          }
                                          {
                                          tmp___48 = strcmp((char const   *)(kind),
                                                            "SCHOTTKY");
                                          }
                                          if (tmp___48 == 0) {
                                            k = 1;
                                          }
                                          {
                                          tmp___49 = strcmp((char const   *)(kind),
                                                            "OHMIC");
                                          }
                                          if (tmp___49 == 0) {
                                            k = 2;
                                          }
                                          {
                                          fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                                 & num);
                                          potential = num;
                                          }
                                          if (k == 2) {
                                            {
                                            fscanf((FILE */* __restrict  */)fp, (char const   */* __restrict  */)"%lf",
                                                   & num);
                                            dens = num;
                                            }
                                          }
                                          if (k == 2) {
                                            if (Model_Number == 1) {
                                              {
                                              fscanf((FILE */* __restrict  */)fp,
                                                     (char const   */* __restrict  */)"%lf",
                                                     & num);
                                              denshole = num;
                                              }
                                            } else
                                            if (Model_Number == 4) {
                                              {
                                              fscanf((FILE */* __restrict  */)fp,
                                                     (char const   */* __restrict  */)"%lf",
                                                     & num);
                                              denshole = num;
                                              }
                                            } else
                                            if (Model_Number == 2) {
                                              {
                                              fscanf((FILE */* __restrict  */)fp,
                                                     (char const   */* __restrict  */)"%lf",
                                                     & num);
                                              denshole = num;
                                              }
                                            } else
                                            if (Model_Number == 5) {
                                              {
                                              fscanf((FILE */* __restrict  */)fp,
                                                     (char const   */* __restrict  */)"%lf",
                                                     & num);
                                              denshole = num;
                                              }
                                            }
                                          }
                                          ini = (int )(ipos / delt) + 1;
                                          fin = (int )(fpos / delt) + 2;
                                          j___0 = ini;
                                          {
                                          while (1) {
                                            while_continue___14: /* CIL Label */ ;
                                            if (! (j___0 <= fin)) {
                                              goto while_break___14;
                                            }
                                            EDGE[i___0][j___0][0] = (double )k;
                                            if (k == 0) {
                                              goto _L___4;
                                            } else
                                            if (k == 1) {
                                              _L___4: 
                                              EDGE[i___0][j___0][1] = potential;
                                              EDGE[i___0][j___0][2] = (double )0;
                                              if (k == 1) {
                                                EDGE[i___0][j___0][2] = NGATE;
                                              }
                                              if (k == 1) {
                                                if (Model_Number == 1) {
                                                  EDGE[i___0][j___0][3] = (double )((NI * NI) / (double const   )NGATE);
                                                } else
                                                if (Model_Number == 4) {
                                                  EDGE[i___0][j___0][3] = (double )((NI * NI) / (double const   )NGATE);
                                                } else
                                                if (Model_Number == 2) {
                                                  EDGE[i___0][j___0][3] = (double )((NI * NI) / (double const   )NGATE);
                                                } else
                                                if (Model_Number == 5) {
                                                  EDGE[i___0][j___0][3] = (double )((NI * NI) / (double const   )NGATE);
                                                }
                                              }
                                            } else
                                            if (k == 2) {
                                              EDGE[i___0][j___0][1] = potential;
                                              EDGE[i___0][j___0][2] = dens;
                                              if (Model_Number == 1) {
                                                EDGE[i___0][j___0][3] = denshole;
                                              } else
                                              if (Model_Number == 4) {
                                                EDGE[i___0][j___0][3] = denshole;
                                              } else
                                              if (Model_Number == 2) {
                                                EDGE[i___0][j___0][3] = denshole;
                                              } else
                                              if (Model_Number == 5) {
                                                EDGE[i___0][j___0][3] = denshole;
                                              }
                                            }
                                            j___0 ++;
                                          }
                                          while_break___34: /* CIL Label */ ;
                                          }
                                          while_break___14: ;
                                          if (k != 2) {
                                            {
                                            printf((char const   */* __restrict  */)"CONTACT %s %g %g %s %g ---> Ok\n",
                                                   pos, ipos, fpos, kind, potential);
                                            }
                                          } else
                                          if (k == 2) {
                                            {
                                            printf((char const   */* __restrict  */)"CONTACT %s %g %g %s %g %g ",
                                                   pos, ipos, fpos, kind, potential,
                                                   dens);
                                            }
                                            if (Model_Number == 1) {
                                              {
                                              printf((char const   */* __restrict  */)"%g ",
                                                     denshole);
                                              }
                                            } else
                                            if (Model_Number == 4) {
                                              {
                                              printf((char const   */* __restrict  */)"%g ",
                                                     denshole);
                                              }
                                            } else
                                            if (Model_Number == 2) {
                                              {
                                              printf((char const   */* __restrict  */)"%g ",
                                                     denshole);
                                              }
                                            } else
                                            if (Model_Number == 5) {
                                              {
                                              printf((char const   */* __restrict  */)"%g ",
                                                     denshole);
                                              }
                                            }
                                            {
                                            printf((char const   */* __restrict  */)"---> Ok\n");
                                            }
                                          }
                                        } else {
                                          {
                                          tmp___59 = strcmp((char const   *)(s), "NOQUANTUMEFFECTS");
                                          }
                                          if (tmp___59 == 0) {
                                            {
                                            Quantum_Flag = 0;
                                            printf((char const   */* __restrict  */)"QUANTUM EFFECTS = NO --->Ok\n");
                                            }
                                          } else {
                                            {
                                            tmp___58 = strcmp((char const   *)(s),
                                                              "QUANTUMEFFECTS");
                                            }
                                            if (tmp___58 == 0) {
                                              {
                                              Quantum_Flag = 1;
                                              printf((char const   */* __restrict  */)"QUANTUM EFFECTS = YES --->Ok\n");
                                              }
                                            } else {
                                              {
                                              tmp___57 = strcmp((char const   *)(s),
                                                                "MEDIA");
                                              }
                                              if (tmp___57 == 0) {
                                                {
                                                fscanf((FILE */* __restrict  */)fp,
                                                       (char const   */* __restrict  */)"%lf",
                                                       & num);
                                                }
                                                if (num < (double )0) {
                                                  {
                                                  printf((char const   */* __restrict  */)"%s: number of media is negative\n",
                                                         progname);
                                                  exit(1);
                                                  }
                                                }
                                                {
                                                MEDIA = (int )num;
                                                printf((char const   */* __restrict  */)"MEDIA = %d ---> Ok\n",
                                                       MEDIA);
                                                }
                                              } else {
                                                {
                                                tmp___56 = strcmp((char const   *)(s),
                                                                  "MAXIMINI");
                                                }
                                                if (tmp___56 == 0) {
                                                  {
                                                  MAXIMINI = 1;
                                                  printf((char const   */* __restrict  */)"MAXIMINI ---> Ok\n");
                                                  }
                                                } else {
                                                  {
                                                  tmp___55 = strcmp((char const   *)(s),
                                                                    "NOMAXIMINI");
                                                  }
                                                  if (tmp___55 == 0) {
                                                    {
                                                    MAXIMINI = 0;
                                                    printf((char const   */* __restrict  */)"NO MAXIMINI ---> Ok\n");
                                                    }
                                                  } else {
                                                    {
                                                    tmp___54 = strcmp((char const   *)(s),
                                                                      "SAVEEACHSTEP");
                                                    }
                                                    if (tmp___54 == 0) {
                                                      {
                                                      SAVEALWAYS = 1;
                                                      printf((char const   */* __restrict  */)"SAVE AT EACH TIME STEP ---> Ok\n");
                                                      }
                                                    } else {
                                                      {
                                                      tmp___53 = strcmp((char const   *)(s),
                                                                        "FARADAY");
                                                      }
                                                      if (tmp___53 == 0) {
                                                        {
                                                        fscanf((FILE */* __restrict  */)fp,
                                                               (char const   */* __restrict  */)"%s",
                                                               s);
                                                        tmp___51 = strcmp((char const   *)(s),
                                                                          "ON");
                                                        }
                                                        if (tmp___51 == 0) {
                                                          FARADAYFLAG = 1;
                                                        } else {
                                                          {
                                                          tmp___50 = strcmp((char const   *)(s),
                                                                            "OFF");
                                                          }
                                                          if (tmp___50 == 0) {
                                                            FARADAYFLAG = 1;
                                                          } else {
                                                            {
                                                            printf((char const   */* __restrict  */)"%s : command FARADAY accept ON or OFF.\n",
                                                                   progname);
                                                            exit(0);
                                                            }
                                                          }
                                                        }
                                                        if (FARADAYFLAG) {
                                                          {
                                                          printf((char const   */* __restrict  */)"FARADAY = ON ---> Ok\n");
                                                          }
                                                        } else {
                                                          {
                                                          printf((char const   */* __restrict  */)"FARADAY = OFF ---> Ok\n");
                                                          }
                                                        }
                                                      } else {
                                                        {
                                                        tmp___52 = strcmp((char const   *)(s),
                                                                          "CONSTANTMAGNETICFIELD");
                                                        }
                                                        if (tmp___52 == 0) {
                                                          {
                                                          fscanf((FILE */* __restrict  */)fp,
                                                                 (char const   */* __restrict  */)"%lf %lf %lf %lf %lf",
                                                                 & xi___0, & yi___0,
                                                                 & xf___0, & yf___0,
                                                                 & value);
                                                          }
                                                          if (xi___0 > xf___0) {
                                                            {
                                                            printf((char const   */* __restrict  */)"%s : %f > %f in CONSTANTMAGNETICFIELD.\n",
                                                                   progname, xi___0,
                                                                   xf___0);
                                                            exit(0);
                                                            }
                                                          }
                                                          if (yi___0 > yf___0) {
                                                            {
                                                            printf((char const   */* __restrict  */)"%s : %f > %f in CONSTANTMAGNETICFIELD.\n",
                                                                   progname, yi___0,
                                                                   yf___0);
                                                            exit(0);
                                                            }
                                                          }
                                                          i = 1;
                                                          {
                                                          while (1) {
                                                            while_continue___15: /* CIL Label */ ;
                                                            if (! (i <= nx + 1)) {
                                                              goto while_break___15;
                                                            }
                                                            j = 1;
                                                            {
                                                            while (1) {
                                                              while_continue___16: /* CIL Label */ ;
                                                              if (! (j <= ny + 1)) {
                                                                goto while_break___16;
                                                              }
                                                              if (((double )i - 0.5) * dx >= xi___0) {
                                                                if (((double )i - 1.5) * dx <= xf___0) {
                                                                  if (((double )j - 0.5) * dy >= yi___0) {
                                                                    if (((double )j - 1.5) * dy <= yf___0) {
                                                                      B[i][j] = value;
                                                                    }
                                                                  }
                                                                }
                                                              }
                                                              j ++;
                                                            }
                                                            while_break___36: /* CIL Label */ ;
                                                            }
                                                            while_break___16: 
                                                            i ++;
                                                          }
                                                          while_break___35: /* CIL Label */ ;
                                                          }
                                                          while_break___15: 
                                                          {
                                                          printf((char const   */* __restrict  */)"Constant Magnetic Field %f %f %f %f %f ---> Ok\n",
                                                                 xi___0, yi___0, xf___0,
                                                                 yf___0, value);
                                                          }
                                                        }
                                                      }
                                                    }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    {
    tmp___79 = feof(fp);
    }
    if (tmp___79) {
      goto while_break___1;
    }
  }
  while_break___21: /* CIL Label */ ;
  }
  while_break___1: 
  DDmax = 0.;
  i = 1;
  {
  while (1) {
    while_continue___17: /* CIL Label */ ;
    if (! (i <= nx + 1)) {
      goto while_break___17;
    }
    j = 1;
    {
    while (1) {
      while_continue___18: /* CIL Label */ ;
      if (! (j <= ny + 1)) {
        goto while_break___18;
      }
      if (DDmax <= N_D[i][j]) {
        DDmax = N_D[i][j];
      }
      j ++;
    }
    while_break___38: /* CIL Label */ ;
    }
    while_break___18: 
    i ++;
  }
  while_break___37: /* CIL Label */ ;
  }
  while_break___17: 
  {
  printf((char const   */* __restrict  */)"=========================\n");
  }
  return;
}
}
void Compute_Currents(void) 
{ 
  register int i ;
  int cn ;
  double sum ;
  char *__cil_tmp16 ;
  char *__cil_tmp17 ;
  char *__cil_tmp18 ;
  char *__cil_tmp19 ;
  char *__cil_tmp20 ;
  char *__cil_tmp21 ;
  char *__cil_tmp22 ;
  char *__cil_tmp23 ;
  char *__cil_tmp24 ;
  char *__cil_tmp25 ;
  char *__cil_tmp26 ;
  char *__cil_tmp27 ;
  {
  sum = 0.;
  cn = 1;
  i = 1;
  {
  while (1) {
    while_continue: /* CIL Label */ ;
    if (! (i <= nx)) {
      goto while_break;
    }
    {
    {
    if (EDGE[0][i][0] == (double )1) {
      goto _L;
    } else
    if (EDGE[0][i][0] == (double )2) {
      _L: 
      if (Model_Number == 0) {
        sum += u2d[i][2][1] * u2d[i][2][3];
      } else
      if (Model_Number == 2) {
        sum += u2d[i][2][1] * u2d[i][2][3];
      } else
      if (Model_Number == 3) {
        sum += u2d[i][3][3];
      } else
      if (Model_Number == 5) {
        sum += u2d[i][3][3];
      }
    }
    }
    }
    if (EDGE[0][i + 1][0] == (double )0) {
      if (sum != 0.) {
        goto _L___0;
      } else {
        goto _L___1;
      }
    } else
    _L___1: 
    if (i == nx) {
      if (sum != 0.) {
        _L___0: 
        if (Model_Number == 0) {
          sum *= (double )((- Q * (double const   )dx) / (double const   )MEDIA);
        } else
        if (Model_Number == 2) {
          sum *= (double )((- Q * (double const   )dx) / (double const   )MEDIA);
        } else
        if (Model_Number == 3) {
          sum *= (double )(- Q * (double const   )dx);
        } else
        if (Model_Number == 5) {
          sum *= (double )(- Q * (double const   )dx);
        }
        {
        printf((char const   */* __restrict  */)"Bottom Edge : Electron Current on contact #%d = %g (A/m)\n",
               cn, sum);
        cn ++;
        sum = 0.;
        }
      }
    }
    i ++;
  }
  while_break___7: /* CIL Label */ ;
  }
  while_break: 
  sum = 0.;
  cn = 1;
  i = 1;
  {
  while (1) {
    while_continue___0: /* CIL Label */ ;
    if (! (i <= ny)) {
      goto while_break___0;
    }
    if (EDGE[1][i][0] == (double )1) {
      goto _L___2;
    } else
    if (EDGE[1][i][0] == (double )2) {
      _L___2: 
      if (Model_Number == 0) {
        sum += u2d[nx - 1][i][1] * u2d[nx - 1][i][2];
      } else
      if (Model_Number == 2) {
        sum += u2d[nx - 1][i][1] * u2d[nx - 1][i][2];
      } else
      if (Model_Number == 3) {
        sum += u2d[nx + 3][i][2];
      } else
      if (Model_Number == 5) {
        sum += u2d[nx + 3][i][2];
      }
    }
    if (EDGE[1][i + 1][0] == (double )0) {
      if (sum != 0.) {
        goto _L___3;
      } else {
        goto _L___4;
      }
    } else
    _L___4: 
    if (i == ny) {
      if (sum != 0.) {
        _L___3: 
        if (Model_Number == 0) {
          sum *= (double )((- Q * (double const   )dy) / (double const   )MEDIA);
        } else
        if (Model_Number == 2) {
          sum *= (double )((- Q * (double const   )dy) / (double const   )MEDIA);
        } else
        if (Model_Number == 3) {
          sum *= (double )(- Q * (double const   )dy);
        } else
        if (Model_Number == 5) {
          sum *= (double )(- Q * (double const   )dy);
        }
        {
        printf((char const   */* __restrict  */)"Right Edge : Electron Current on contact #%d = %g (A/m)\n",
               cn, sum);
        cn ++;
        sum = 0.;
        }
      }
    }
    i ++;
  }
  while_break___8: /* CIL Label */ ;
  }
  while_break___0: 
  sum = 0.;
  cn = 1;
  i = 1;
  {
  while (1) {
    while_continue___1: /* CIL Label */ ;
    if (! (i <= nx)) {
      goto while_break___1;
    }
    if (EDGE[2][i][0] == (double )1) {
      goto _L___5;
    } else
    if (EDGE[2][i][0] == (double )2) {
      _L___5: 
      if (Model_Number == 0) {
        sum += u2d[i][ny - 1][1] * u2d[i][ny - 1][3];
      } else
      if (Model_Number == 2) {
        sum += u2d[i][ny - 1][1] * u2d[i][ny - 1][3];
      } else
      if (Model_Number == 3) {
        sum += u2d[i][ny + 3][3];
      } else
      if (Model_Number == 5) {
        sum += u2d[i][ny + 3][3];
      }
    }
    if (EDGE[2][i + 1][0] == (double )0) {
      if (sum != 0.) {
        goto _L___6;
      } else {
        goto _L___7;
      }
    } else
    _L___7: 
    if (i == nx) {
      if (sum != 0.) {
        _L___6: 
        if (Model_Number == 0) {
          sum *= (double )((- Q * (double const   )dx) / (double const   )MEDIA);
        } else
        if (Model_Number == 2) {
          sum *= (double )((- Q * (double const   )dx) / (double const   )MEDIA);
        } else
        if (Model_Number == 3) {
          sum *= (double )(- Q * (double const   )dx);
        } else
        if (Model_Number == 5) {
          sum *= (double )(- Q * (double const   )dx);
        }
        {
        printf((char const   */* __restrict  */)"Upper Edge : Electron Current on contact #%d = %g (A/m)\n",
               cn, sum);
        cn ++;
        sum = 0.;
        }
      }
    }
    i ++;
  }
  while_break___9: /* CIL Label */ ;
  }
  while_break___1: 
  sum = 0.;
  cn = 1;
  i = 1;
  {
  while (1) {
    while_continue___2: /* CIL Label */ ;
    if (! (i <= ny)) {
      goto while_break___2;
    }
    if (EDGE[3][i][0] == (double )1) {
      goto _L___8;
    } else
    if (EDGE[3][i][0] == (double )2) {
      _L___8: 
      if (Model_Number == 0) {
        sum += u2d[2][i][1] * u2d[2][i][2];
      } else
      if (Model_Number == 2) {
        sum += u2d[2][i][1] * u2d[2][i][2];
      } else
      if (Model_Number == 3) {
        sum += u2d[3][i][2];
      } else
      if (Model_Number == 5) {
        sum += u2d[3][i][2];
      }
    }
    if (EDGE[3][i + 1][0] == (double )0) {
      if (sum != 0.) {
        goto _L___9;
      } else {
        goto _L___10;
      }
    } else
    _L___10: 
    if (i == ny) {
      if (sum != 0.) {
        _L___9: 
        if (Model_Number == 0) {
          sum *= (double )((- Q * (double const   )dy) / (double const   )MEDIA);
        } else
        if (Model_Number == 2) {
          sum *= (double )((- Q * (double const   )dy) / (double const   )MEDIA);
        } else
        if (Model_Number == 3) {
          sum *= (double )(- Q * (double const   )dy);
        } else
        if (Model_Number == 5) {
          sum *= (double )(- Q * (double const   )dy);
        }
        {
        printf((char const   */* __restrict  */)"Left Edge : Electron Current on contact #%d = %g (A/m)\n",
               cn, sum);
        cn ++;
        sum = 0.;
        }
      }
    }
    i ++;
  }
  while_break___10: /* CIL Label */ ;
  }
  while_break___2: ;
  if (Model_Number == 2) {
    goto _L___15;
  } else
  if (Model_Number == 1) {
    goto _L___15;
  } else
  if (Model_Number == 5) {
    goto _L___15;
  } else
  if (Model_Number == 4) {
    _L___15: 
    sum = 0.;
    cn = 1;
    i = 1;
    {
    while (1) {
      while_continue___3: /* CIL Label */ ;
      if (! (i <= nx)) {
        goto while_break___3;
      }
      if (EDGE[0][i][0] == (double )1) {
        sum += h2d[i][3][3];
      } else
      if (EDGE[0][i][0] == (double )2) {
        sum += h2d[i][3][3];
      }
      if (EDGE[0][i + 1][0] == (double )0) {
        if (sum != 0.) {
          {
          sum *= (double )(- Q * (double const   )dx);
          printf((char const   */* __restrict  */)"Bottom Edge : Hole Current on contact #%d = %g (A/m)\n",
                 cn, sum);
          cn ++;
          sum = 0.;
          }
        } else {
          goto _L___11;
        }
      } else
      _L___11: 
      if (i == nx) {
        if (sum != 0.) {
          {
          sum *= (double )(- Q * (double const   )dx);
          printf((char const   */* __restrict  */)"Bottom Edge : Hole Current on contact #%d = %g (A/m)\n",
                 cn, sum);
          cn ++;
          sum = 0.;
          }
        }
      }
      i ++;
    }
    while_break___11: /* CIL Label */ ;
    }
    while_break___3: 
    sum = 0.;
    cn = 1;
    i = 1;
    {
    while (1) {
      while_continue___4: /* CIL Label */ ;
      if (! (i <= ny)) {
        goto while_break___4;
      }
      if (EDGE[1][i][0] == (double )1) {
        sum += h2d[nx + 3][i][2];
      } else
      if (EDGE[1][i][0] == (double )2) {
        sum += h2d[nx + 3][i][2];
      }
      if (EDGE[1][i + 1][0] == (double )0) {
        if (sum != 0.) {
          {
          sum *= (double )(- Q * (double const   )dy);
          printf((char const   */* __restrict  */)"Right Edge : Hole Current on contact #%d = %g (A/m)\n",
                 cn, sum);
          cn ++;
          sum = 0.;
          }
        } else {
          goto _L___12;
        }
      } else
      _L___12: 
      if (i == ny) {
        if (sum != 0.) {
          {
          sum *= (double )(- Q * (double const   )dy);
          printf((char const   */* __restrict  */)"Right Edge : Hole Current on contact #%d = %g (A/m)\n",
                 cn, sum);
          cn ++;
          sum = 0.;
          }
        }
      }
      i ++;
    }
    while_break___12: /* CIL Label */ ;
    }
    while_break___4: 
    sum = 0.;
    cn = 1;
    i = 1;
    {
    while (1) {
      while_continue___5: /* CIL Label */ ;
      if (! (i <= nx)) {
        goto while_break___5;
      }
      if (EDGE[2][i][0] == (double )1) {
        sum += h2d[i][ny + 3][3];
      } else
      if (EDGE[2][i][0] == (double )2) {
        sum += h2d[i][ny + 3][3];
      }
      if (EDGE[2][i + 1][0] == (double )0) {
        if (sum != 0.) {
          {
          sum *= (double )(- Q * (double const   )dx);
          printf((char const   */* __restrict  */)"Upper Edge : Hole Current on contact #%d = %g (A/m)\n",
                 cn, sum);
          cn ++;
          sum = 0.;
          }
        } else {
          goto _L___13;
        }
      } else
      _L___13: 
      if (i == nx) {
        if (sum != 0.) {
          {
          sum *= (double )(- Q * (double const   )dx);
          printf((char const   */* __restrict  */)"Upper Edge : Hole Current on contact #%d = %g (A/m)\n",
                 cn, sum);
          cn ++;
          sum = 0.;
          }
        }
      }
      i ++;
    }
    while_break___13: /* CIL Label */ ;
    }
    while_break___5: 
    sum = 0.;
    cn = 1;
    i = 1;
    {
    while (1) {
      while_continue___6: /* CIL Label */ ;
      if (! (i <= ny)) {
        goto while_break___6;
      }
      if (EDGE[3][i][0] == (double )1) {
        sum += h2d[3][i][2];
      } else
      if (EDGE[3][i][0] == (double )2) {
        sum += h2d[3][i][2];
      }
      if (EDGE[3][i + 1][0] == (double )0) {
        if (sum != 0.) {
          {
          sum *= (double )(- Q * (double const   )dy);
          printf((char const   */* __restrict  */)"Left Edge : Hole Current on contact #%d = %g (A/m)\n",
                 cn, sum);
          cn ++;
          sum = 0.;
          }
        } else {
          goto _L___14;
        }
      } else
      _L___14: 
      if (i == ny) {
        if (sum != 0.) {
          {
          sum *= (double )(- Q * (double const   )dy);
          printf((char const   */* __restrict  */)"Left Edge : Hole Current on contact #%d = %g (A/m)\n",
                 cn, sum);
          cn ++;
          sum = 0.;
          }
        }
      }
      i ++;
    }
    while_break___14: /* CIL Label */ ;
    }
    while_break___6: ;
  }
  return;
}
}
void electron_relaxation_step(void) 
{ 
  int ND ;
  register int i ;
  register int j ;
  register int c___0 ;
  double taup ;
  double t ;
  double ktaup ;
  double ktauw ;
  double tmp ;
  {
  ND = 2;
  c___0 = 1;
  {
  while (1) {
    while_continue: /* CIL Label */ ;
    if (! (c___0 <= 50)) {
      goto while_break;
    }
    i = ND;
    {
    while (1) {
      while_continue___0: /* CIL Label */ ;
      if (! (i <= nx + ND)) {
        goto while_break___0;
      }
      j = ND;
      {
      while (1) {
        while_continue___1: /* CIL Label */ ;
        if (! (j <= ny + ND)) {
          goto while_break___1;
        }
        {
        t = ((2. / 3.) * (u2d[i][j][4] / u2d[i][j][1])) / (double )KB;
        ktaup = (double )((((M * (double const   )MSTAR[i_dom[i][j]][1]) * (double const   )MIU0) * (double const   )TL) / Q);
        ktauw = ((MIU0 * TL) * (double )KB) / (double )((Q * (double const   )VS) * (double const   )VS);
        taup = ktaup / t;
        tmp = tauwi((1.5 * (double )KB) * t);
        u2d[i][j][4] += (- DT / 50.) * (double )(Q * (double const   )(u2d[i][j][2] * E[i - 1][j - 1][0] + u2d[i][j][3] * E[i - 1][j - 1][1]) + (double const   )((((u2d[i][j][1] * 1.5) * (double )KB) * (t - TL)) / tmp));
        u2d[i][j][2] += (- DT / 50.) * (((u2d[i][j][1] * (double )Q) * E[i - 1][j - 1][0]) / (double )(M * (double const   )MSTAR[i_dom[i][j]][1]) + u2d[i][j][2] / taup);
        u2d[i][j][3] += (- DT / 50.) * (((u2d[i][j][1] * (double )Q) * E[i - 1][j - 1][1]) / (double )(M * (double const   )MSTAR[i_dom[i][j]][1]) + u2d[i][j][3] / taup);
        j ++;
        }
      }
      while_break___4: /* CIL Label */ ;
      }
      while_break___1: 
      i ++;
    }
    while_break___3: /* CIL Label */ ;
    }
    while_break___0: 
    c___0 ++;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: ;
  return;
}
}
void ParabMEP2D(int nx___0 , int ny___0 , double dx___0 , double dy___0 , double cfl ,
                double theta ) 
{ 
  int ND ;
  register int m ;
  register int i ;
  register int j ;
  double den ;
  double xmt ;
  double ymt ;
  double eng ;
  double vex ;
  double vey ;
  double dt ;
  double dtodx2 ;
  double dtody2 ;
  int io ;
  int NXE ;
  int NYE ;
  {
  ND = 2;
  NXE = nx___0 + ND;
  NYE = ny___0 + ND;
  io = 0;
  {
  while (1) {
    while_continue: /* CIL Label */ ;
    if (! (io <= 1)) {
      goto while_break;
    }
    {
    HMEPBCs();
    m = 1;
    }
    {
    while (1) {
      while_continue___0: /* CIL Label */ ;
      if (! (m <= 4)) {
        goto while_break___0;
      }
      j = ND - 2;
      {
      while (1) {
        while_continue___1: /* CIL Label */ ;
        if (! (j <= NYE + 2)) {
          goto while_break___1;
        }
        i = ND - 2;
        {
        while (1) {
          while_continue___2: /* CIL Label */ ;
          if (! (i <= NXE + 2)) {
            goto while_break___2;
          }
          bufx2d[i][j] = u2d[i + 1][j][m] - u2d[i][j][m];
          bufy2d[i][j] = u2d[i][j + 1][m] - u2d[i][j][m];
          i ++;
        }
        while_break___22: /* CIL Label */ ;
        }
        while_break___2: 
        j ++;
      }
      while_break___21: /* CIL Label */ ;
      }
      while_break___1: 
      j = ND;
      {
      while (1) {
        while_continue___3: /* CIL Label */ ;
        if (! (j <= NYE + 1)) {
          goto while_break___3;
        }
        i = ND;
        {
        while (1) {
          while_continue___4: /* CIL Label */ ;
          if (! (i <= NXE + 1)) {
            goto while_break___4;
          }
          {
          ux2d[i][j][m] = MM2(theta, bufx2d[i - 1][j], bufx2d[i][j]);
          uy2d[i][j][m] = MM2(theta, bufy2d[i][j - 1], bufy2d[i][j]);
          i ++;
          }
        }
        while_break___24: /* CIL Label */ ;
        }
        while_break___4: 
        j ++;
      }
      while_break___23: /* CIL Label */ ;
      }
      while_break___3: 
      m ++;
    }
    while_break___20: /* CIL Label */ ;
    }
    while_break___0: 
    j = ND - 2;
    {
    while (1) {
      while_continue___5: /* CIL Label */ ;
      if (! (j <= NYE + 3)) {
        goto while_break___5;
      }
      i = ND - 2;
      {
      while (1) {
        while_continue___6: /* CIL Label */ ;
        if (! (i <= NXE + 3)) {
          goto while_break___6;
        }
        den = u2d[i][j][1];
        xmt = u2d[i][j][2];
        ymt = u2d[i][j][3];
        eng = u2d[i][j][4];
        vex = xmt / den;
        vey = ymt / den;
        f2d[i][j][1] = xmt;
        f2d[i][j][2] = (2. / ((3. * MSTAR[i_dom[i][j]][1]) * (double )M)) * eng;
        f2d[i][j][3] = 0.;
        f2d[i][j][4] = ((4. / 3.) * eng) * vex;
        g2d[i][j][1] = ymt;
        g2d[i][j][2] = 0.0;
        g2d[i][j][3] = (2. / ((3. * MSTAR[i_dom[i][j]][1]) * (double )M)) * eng;
        g2d[i][j][4] = ((4. / 3.) * eng) * vey;
        i ++;
      }
      while_break___26: /* CIL Label */ ;
      }
      while_break___6: 
      j ++;
    }
    while_break___25: /* CIL Label */ ;
    }
    while_break___5: 
    m = 1;
    {
    while (1) {
      while_continue___7: /* CIL Label */ ;
      if (! (m <= 4)) {
        goto while_break___7;
      }
      j = ND - 2;
      {
      while (1) {
        while_continue___8: /* CIL Label */ ;
        if (! (j <= NYE + 2)) {
          goto while_break___8;
        }
        i = ND - 2;
        {
        while (1) {
          while_continue___9: /* CIL Label */ ;
          if (! (i <= NXE + 2)) {
            goto while_break___9;
          }
          bufx2d[i][j] = f2d[i + 1][j][m] - f2d[i][j][m];
          bufy2d[i][j] = g2d[i][j + 1][m] - g2d[i][j][m];
          i ++;
        }
        while_break___29: /* CIL Label */ ;
        }
        while_break___9: 
        j ++;
      }
      while_break___28: /* CIL Label */ ;
      }
      while_break___8: 
      j = ND;
      {
      while (1) {
        while_continue___10: /* CIL Label */ ;
        if (! (j <= NYE + 1)) {
          goto while_break___10;
        }
        i = ND;
        {
        while (1) {
          while_continue___11: /* CIL Label */ ;
          if (! (i <= NXE + 1)) {
            goto while_break___11;
          }
          {
          fx2d[i][j][m] = MM2(theta, bufx2d[i - 1][j], bufx2d[i][j]);
          gy2d[i][j][m] = MM2(theta, bufy2d[i][j - 1], bufy2d[i][j]);
          i ++;
          }
        }
        while_break___31: /* CIL Label */ ;
        }
        while_break___11: 
        j ++;
      }
      while_break___30: /* CIL Label */ ;
      }
      while_break___10: 
      m ++;
    }
    while_break___27: /* CIL Label */ ;
    }
    while_break___7: 
    j = ND;
    {
    while (1) {
      while_continue___12: /* CIL Label */ ;
      if (! (j <= NYE + 1)) {
        goto while_break___12;
      }
      i = ND;
      {
      while (1) {
        while_continue___13: /* CIL Label */ ;
        if (! (i <= NXE + 1)) {
          goto while_break___13;
        }
        den = (u2d[i][j][1] - dtodx2 * fx2d[i][j][1]) - dtody2 * gy2d[i][j][1];
        xmt = (u2d[i][j][2] - dtodx2 * fx2d[i][j][2]) - dtody2 * gy2d[i][j][2];
        ymt = (u2d[i][j][3] - dtodx2 * fx2d[i][j][3]) - dtody2 * gy2d[i][j][3];
        eng = (u2d[i][j][4] - dtodx2 * fx2d[i][j][4]) - dtody2 * gy2d[i][j][4];
        vex = xmt / den;
        vey = ymt / den;
        f2d[i][j][1] = xmt;
        f2d[i][j][2] = (2. / ((3. * MSTAR[i_dom[i][j]][1]) * (double )M)) * eng;
        f2d[i][j][3] = 0.0;
        f2d[i][j][4] = ((4. / 3.) * eng) * vex;
        g2d[i][j][1] = ymt;
        g2d[i][j][2] = 0.0;
        g2d[i][j][3] = (2. / ((3. * MSTAR[i_dom[i][j]][1]) * (double )M)) * eng;
        g2d[i][j][4] = ((4. / 3.) * eng) * vey;
        i ++;
      }
      while_break___33: /* CIL Label */ ;
      }
      while_break___13: 
      j ++;
    }
    while_break___32: /* CIL Label */ ;
    }
    while_break___12: ;
    if (io == 0) {
      dt = DT;
      if (TEMPO + 2. * dt >= TF) {
        dt = 0.5 * (TF - TEMPO);
      }
    }
    dtodx2 = (0.5 * dt) / dx___0;
    dtody2 = (0.5 * dt) / dy___0;
    TEMPO += dt;
    m = 1;
    {
    while (1) {
      while_continue___14: /* CIL Label */ ;
      if (! (m <= 4)) {
        goto while_break___14;
      }
      j = (ND + 1) - io;
      {
      while (1) {
        while_continue___15: /* CIL Label */ ;
        if (! (j <= NYE - io)) {
          goto while_break___15;
        }
        i = (ND + 1) - io;
        {
        while (1) {
          while_continue___16: /* CIL Label */ ;
          if (! (i <= NXE - io)) {
            goto while_break___16;
          }
          bufx2d[i][j] = ((0.25 * (((u2d[i][j][m] + u2d[i + 1][j][m]) + u2d[i][j + 1][m]) + u2d[i + 1][j + 1][m]) + 0.0625 * (((((((ux2d[i][j][m] - ux2d[i + 1][j][m]) + ux2d[i][j + 1][m]) - ux2d[i + 1][j + 1][m]) + uy2d[i][j][m]) + uy2d[i + 1][j][m]) - uy2d[i][j + 1][m]) - uy2d[i + 1][j + 1][m])) + dtodx2 * (((f2d[i][j][m] - f2d[i + 1][j][m]) + f2d[i][j + 1][m]) - f2d[i + 1][j + 1][m])) + dtody2 * (((g2d[i][j][m] + g2d[i + 1][j][m]) - g2d[i][j + 1][m]) - g2d[i + 1][j + 1][m]);
          i ++;
        }
        while_break___36: /* CIL Label */ ;
        }
        while_break___16: 
        j ++;
      }
      while_break___35: /* CIL Label */ ;
      }
      while_break___15: 
      j = ND + 1;
      {
      while (1) {
        while_continue___17: /* CIL Label */ ;
        if (! (j <= NYE)) {
          goto while_break___17;
        }
        i = ND + 1;
        {
        while (1) {
          while_continue___18: /* CIL Label */ ;
          if (! (i <= NXE)) {
            goto while_break___18;
          }
          u2d[i][j][m] = bufx2d[i - io][j - io];
          i ++;
        }
        while_break___38: /* CIL Label */ ;
        }
        while_break___18: 
        j ++;
      }
      while_break___37: /* CIL Label */ ;
      }
      while_break___17: 
      m ++;
    }
    while_break___34: /* CIL Label */ ;
    }
    while_break___14: 
    io ++;
  }
  while_break___19: /* CIL Label */ ;
  }
  while_break: ;
  return;
}
}
void HMEPBCs(void) 
{ 
  int i ;
  int j ;
  double xvel ;
  double yvel ;
  {
  i = 0;
  {
  while (1) {
    while_continue: /* CIL Label */ ;
    if (! (i <= nx + 2)) {
      goto while_break;
    }
    {
    if (EDGE[0][i][0] == (double )0) {
      u2d[i + 2][0][1] = u2d[i + 2][5][1];
      u2d[i + 2][1][1] = u2d[i + 2][4][1];
      u2d[i + 2][2][1] = u2d[i + 2][3][1];
      airac_observe(u2d, i + 2);
      u2d[i + 2][0][2] = u2d[i + 2][5][2];
      u2d[i + 2][1][2] = u2d[i + 2][4][2];
      u2d[i + 2][2][2] = u2d[i + 2][3][2];
      u2d[i + 2][0][3] = u2d[i + 2][5][3];
      u2d[i + 2][1][3] = u2d[i + 2][4][3];
      u2d[i + 2][2][3] = u2d[i + 2][3][3];
      u2d[i + 2][0][4] = u2d[i + 2][5][4];
      u2d[i + 2][1][4] = u2d[i + 2][4][4];
      u2d[i + 2][2][4] = u2d[i + 2][3][4];
    }
    }
    if (EDGE[0][i][0] == (double )1) {
      goto _L;
    } else
    if (EDGE[0][i][0] == (double )2) {
      _L: 
      yvel = u2d[i + 2][3][3] / u2d[i + 2][3][1];
      u2d[i + 2][0][1] = EDGE[0][i][2];
      u2d[i + 2][1][1] = EDGE[0][i][2];
      u2d[i + 2][2][1] = EDGE[0][i][2];
      u2d[i + 2][0][2] = 0.;
      u2d[i + 2][1][2] = 0.;
      u2d[i + 2][2][2] = 0.;
      u2d[i + 2][0][3] = EDGE[0][i][2] * yvel;
      u2d[i + 2][1][3] = EDGE[0][i][2] * yvel;
      u2d[i + 2][2][3] = EDGE[0][i][2] * yvel;
      u2d[i + 2][0][4] = ((((0.5 * MSTAR[i_dom[i + 2][3]][1]) * (double )M) * yvel) * yvel) * EDGE[0][i][2] + ((1.5 * (double )KB) * TL) * EDGE[0][i][2];
      u2d[i + 2][1][4] = ((((0.5 * MSTAR[i_dom[i + 2][3]][1]) * (double )M) * yvel) * yvel) * EDGE[0][i][2] + ((1.5 * (double )KB) * TL) * EDGE[0][i][2];
      u2d[i + 2][2][4] = ((((0.5 * MSTAR[i_dom[i + 2][3]][1]) * (double )M) * yvel) * yvel) * EDGE[0][i][2] + ((1.5 * (double )KB) * TL) * EDGE[0][i][2];
    }
    i ++;
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break: 
  j = 1;
  {
  while (1) {
    while_continue___0: /* CIL Label */ ;
    if (! (j <= ny + 2)) {
      goto while_break___0;
    }
    if (EDGE[3][j][0] == (double )0) {
      u2d[0][j + 2][1] = u2d[5][j + 2][1];
      u2d[1][j + 2][1] = u2d[4][j + 2][1];
      u2d[2][j + 2][1] = u2d[3][j + 2][1];
      u2d[0][j][2] = u2d[5][j + 2][2];
      u2d[1][j][2] = u2d[4][j + 2][2];
      u2d[2][j][2] = u2d[3][j + 2][2];
      u2d[0][j + 2][3] = u2d[5][j + 2][3];
      u2d[1][j + 2][3] = u2d[4][j + 2][3];
      u2d[2][j + 2][3] = u2d[3][j + 2][3];
      u2d[0][j + 2][4] = u2d[5][j + 2][4];
      u2d[1][j + 2][4] = u2d[4][j + 2][4];
      u2d[2][j + 2][4] = u2d[3][j + 2][4];
    }
    if (EDGE[3][j][0] == (double )1) {
      goto _L___0;
    } else
    if (EDGE[3][j][0] == (double )2) {
      _L___0: 
      xvel = u2d[3][j + 2][2] / u2d[3][j + 2][1];
      u2d[0][j + 2][1] = EDGE[3][j][2];
      u2d[1][j + 2][1] = EDGE[3][j][2];
      u2d[2][j + 2][1] = EDGE[3][j][2];
      u2d[0][j + 2][2] = EDGE[3][j][2] * xvel;
      u2d[1][j + 2][2] = EDGE[3][j][2] * xvel;
      u2d[2][j + 2][2] = EDGE[3][j][2] * xvel;
      u2d[0][j + 2][3] = 0.;
      u2d[1][j + 2][3] = 0.;
      u2d[2][j + 2][3] = 0.;
      u2d[0][j + 2][4] = ((((0.5 * MSTAR[i_dom[3][j + 2]][1]) * (double )M) * xvel) * xvel) * EDGE[3][j][2] + ((1.5 * (double )KB) * TL) * EDGE[3][j][2];
      u2d[1][j + 2][4] = ((((0.5 * MSTAR[i_dom[3][j + 2]][1]) * (double )M) * xvel) * xvel) * EDGE[3][j][2] + ((1.5 * (double )KB) * TL) * EDGE[3][j][2];
      u2d[2][j + 2][4] = ((((0.5 * MSTAR[i_dom[3][j + 2]][1]) * (double )M) * xvel) * xvel) * EDGE[3][j][2] + ((1.5 * (double )KB) * TL) * EDGE[3][j][2];
    }
    j ++;
  }
  while_break___4: /* CIL Label */ ;
  }
  while_break___0: 
  j = 1;
  {
  while (1) {
    while_continue___1: /* CIL Label */ ;
    if (! (j <= ny + 2)) {
      goto while_break___1;
    }
    if (EDGE[1][j][0] == (double )0) {
      u2d[nx + 2][j + 2][1] = u2d[nx + 1][j + 2][1];
      u2d[nx + 3][j + 2][1] = u2d[nx][j + 2][1];
      u2d[nx + 4][j + 2][1] = u2d[nx - 1][j + 2][1];
      u2d[nx + 2][j + 2][2] = u2d[nx + 1][j + 2][2];
      u2d[nx + 3][j + 2][2] = u2d[nx][j + 2][2];
      u2d[nx + 4][j + 2][2] = u2d[nx - 1][j + 2][2];
      u2d[nx + 2][j + 2][3] = u2d[nx + 1][j + 2][3];
      u2d[nx + 3][j + 2][3] = u2d[nx][j + 2][3];
      u2d[nx + 4][j + 2][3] = u2d[nx - 1][j + 2][3];
      u2d[nx + 2][j + 2][4] = u2d[nx + 1][j + 2][4];
      u2d[nx + 3][j + 2][4] = u2d[nx][j + 2][4];
      u2d[nx + 4][j + 2][4] = u2d[nx - 1][j + 2][4];
    }
    if (EDGE[1][j][0] == (double )1) {
      goto _L___1;
    } else
    if (EDGE[1][j][0] == (double )2) {
      _L___1: 
      xvel = u2d[nx - 1][j + 2][2] / u2d[nx - 1][j + 2][1];
      u2d[nx + 2][j + 2][1] = EDGE[1][j][2];
      u2d[nx + 3][j + 2][1] = EDGE[1][j][2];
      u2d[nx + 4][j + 2][1] = EDGE[1][j][2];
      u2d[nx + 2][j + 2][2] = EDGE[1][j][2] * xvel;
      u2d[nx + 3][j + 2][2] = EDGE[1][j][2] * xvel;
      u2d[nx + 4][j + 2][2] = EDGE[1][j][2] * xvel;
      u2d[nx + 2][j + 2][3] = 0.;
      u2d[nx + 3][j + 2][3] = 0.;
      u2d[nx + 4][j + 2][3] = 0.;
      u2d[nx + 2][j + 2][4] = ((((0.5 * MSTAR[i_dom[nx - 1][j + 2]][1]) * (double )M) * xvel) * xvel) * EDGE[1][j][2] + ((1.5 * (double )KB) * TL) * EDGE[1][j][2];
      u2d[nx + 3][j + 2][4] = ((((0.5 * MSTAR[i_dom[nx - 1][j + 2]][1]) * (double )M) * xvel) * xvel) * EDGE[1][j][2] + ((1.5 * (double )KB) * TL) * EDGE[1][j][2];
      u2d[nx + 4][j + 2][4] = ((((0.5 * MSTAR[i_dom[nx - 1][j + 2]][1]) * (double )M) * xvel) * xvel) * EDGE[1][j][2] + ((1.5 * (double )KB) * TL) * EDGE[1][j][2];
    }
    j ++;
  }
  while_break___5: /* CIL Label */ ;
  }
  while_break___1: 
  i = 1;
  {
  while (1) {
    while_continue___2: /* CIL Label */ ;
    if (! (i <= nx + 2)) {
      goto while_break___2;
    }
    if (EDGE[2][i][0] == (double )0) {
      u2d[i + 2][ny + 2][1] = u2d[i + 2][ny + 1][1];
      u2d[i + 2][ny + 3][1] = u2d[i + 2][ny][1];
      u2d[i + 2][ny + 4][1] = u2d[i + 2][ny - 1][1];
      u2d[i + 2][ny + 2][2] = u2d[i + 2][ny + 1][2];
      u2d[i + 2][ny + 3][2] = u2d[i + 2][ny][2];
      u2d[i + 2][ny + 4][2] = u2d[i + 2][ny - 1][2];
      u2d[i + 2][ny + 2][3] = u2d[i + 2][ny + 1][3];
      u2d[i + 2][ny + 3][3] = u2d[i + 2][ny][3];
      u2d[i + 2][ny + 4][3] = u2d[i + 2][ny - 1][3];
      u2d[i + 2][ny + 2][4] = u2d[i + 2][ny + 1][4];
      u2d[i + 2][ny + 3][4] = u2d[i + 2][ny][4];
      u2d[i + 2][ny + 4][4] = u2d[i + 2][ny - 1][4];
    }
    if (EDGE[2][i][0] == (double )1) {
      goto _L___2;
    } else
    if (EDGE[2][i][0] == (double )2) {
      _L___2: 
      yvel = u2d[i + 2][ny - 1][3] / u2d[i + 2][ny - 1][1];
      u2d[i + 2][ny + 2][1] = EDGE[2][i][2];
      u2d[i + 2][ny + 3][1] = EDGE[2][i][2];
      u2d[i + 2][ny + 4][1] = EDGE[2][i][2];
      u2d[i + 2][ny + 2][2] = 0.;
      u2d[i + 2][ny + 3][2] = 0.;
      u2d[i + 2][ny + 4][2] = 0.;
      u2d[i + 2][ny + 2][3] = EDGE[2][i][2] * yvel;
      u2d[i + 2][ny + 3][3] = EDGE[2][i][2] * yvel;
      u2d[i + 2][ny + 4][3] = EDGE[2][i][2] * yvel;
      u2d[i + 2][ny + 2][4] = ((((0.5 * MSTAR[i_dom[i + 2][ny - 1]][1]) * (double )M) * yvel) * yvel) * EDGE[2][i][2] + ((1.5 * (double )KB) * TL) * EDGE[2][i][2];
      u2d[i + 2][ny + 3][4] = ((((0.5 * MSTAR[i_dom[i + 2][ny - 1]][1]) * (double )M) * yvel) * yvel) * EDGE[2][i][2] + ((1.5 * (double )KB) * TL) * EDGE[2][i][2];
      u2d[i + 2][ny + 4][4] = ((((0.5 * MSTAR[i_dom[i + 2][ny - 1]][1]) * (double )M) * yvel) * yvel) * EDGE[2][i][2] + ((1.5 * (double )KB) * TL) * EDGE[2][i][2];
    }
    i ++;
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break___2: ;
  return;
}
}
void MEP_coefficients(void) 
{ 
  {
  c11[1] = 7.4985705e-016;
  c11[2] = - 3.6122279e-015;
  c11[3] = 3.9232487e-014;
  c11[4] = 9.1529095e-014;
  c11[5] = - 4.4414692e-015;
  c11[6] = - 1.7323853e-016;
  c12[1] = - 1.3646041e-012;
  c12[2] = 8.1197009e-012;
  c12[3] = - 1.7070415e-011;
  c12[4] = 1.5010866e-011;
  c12[5] = - 5.2241407e-012;
  c12[6] = 4.2032095e-013;
  c21[1] = 2.1940086e12;
  c21[2] = - 1.4192452e13;
  c21[3] = 1.5400896e14;
  c21[4] = 2.2927873e14;
  c21[5] = 2.3734694e12;
  c21[6] = 1.2666909e11;
  c22[1] = - 1.1216571e13;
  c22[2] = 6.4708042e13;
  c22[3] = - 1.2457850e14;
  c22[4] = - 1.1229164e14;
  c22[5] = - 3.3463063e14;
  c22[6] = - 4.0441071e12;
  u[1] = 1.2031722e-2;
  u[2] = - 8.2472023e-2;
  u[3] = 2.2075893e-1;
  u[4] = - 3.1204242e-1;
  u[5] = 6.3963512e-1;
  u[6] = 7.4669684e-4;
  f[1] = - 2.2156802e-2;
  f[2] = 1.4648397e-1;
  f[3] = - 3.6560368e-1;
  f[4] = 4.3888833e-1;
  f[5] = 6.7589719e-2;
  f[6] = - 1.7639096e-3;
  g[1] = 8.5792683e-2;
  g[2] = - 5.7152259e-1;
  g[3] = 1.4517340;
  g[4] = - 1.8382828;
  g[5] = 1.4079332;
  g[6] = 6.7206574e-3;
  cw[1] = - 7.2429491e10;
  cw[2] = 5.1342003e11;
  cw[3] = - 1.3655677e12;
  cw[4] = 3.6907365e11;
  cw[5] = - 3.0788470e12;
  cw[6] = 9.9708156e10;
  return;
}
}
double c11i(double t ) 
{ 
  double W ;
  double tmp ;
  double tmp___0 ;
  double tmp___1 ;
  double tmp___2 ;
  {
  {
  W = t / (double )Q;
  tmp = pow(W, 5.);
  tmp___0 = pow(W, 4.);
  tmp___1 = pow(W, 3.);
  tmp___2 = pow(W, 2.);
  }
  return ((((((c11[1] * tmp + c11[2] * tmp___0) + c11[3] * tmp___1) + c11[4] * tmp___2) + c11[5] * W) + c11[6]) * 1.e-3);
}
}
double c12i(double t ) 
{ 
  double W ;
  double tmp ;
  double tmp___0 ;
  double tmp___1 ;
  double tmp___2 ;
  {
  {
  W = t / (double )Q;
  tmp = pow(W, 5.);
  tmp___0 = pow(W, 4.);
  tmp___1 = pow(W, 3.);
  tmp___2 = pow(W, 2.);
  }
  return (((((((c12[1] * tmp + c12[2] * tmp___0) + c12[3] * tmp___1) + c12[4] * tmp___2) + c12[5] * W) + c12[6]) * 1.e-3) / (double )Q);
}
}
 
;
 
;
 
;
double tauwi(double t ) 
;
 
;
 
;
 
;
void Hole_MEP2D(int nx___0 , int ny___0 , double dx___0 , double dy___0 , double cfl ,
                double theta ) 
{ 
  int ND ;
  register int m ;
  register int i ;
  register int j ;
  int io ;
  int NXE ;
  int NYE ;
  double den ;
  double xmt ;
  double ymt ;
  double eng ;
  double vex ;
  double vey ;
  double dtodx2 ;
  double dtody2 ;
  double dt ;
  {
  {
  ND = 2;
  NXE = nx___0 + ND;
  NYE = ny___0 + ND;
  memset((void *)(bufx2d), 0, (size_t )sizeof(& bufx2d));
  memset((void *)(bufy2d), 0, (size_t )sizeof(& bufy2d));
  memset((void *)(ux2d), 0, (size_t )sizeof(& ux2d));
  memset((void *)(uy2d), 0, (size_t )sizeof(& uy2d));
  memset((void *)(f2d), 0, (size_t )sizeof(& f2d));
  memset((void *)(g2d), 0, (size_t )sizeof(& g2d));
  memset((void *)(fx2d), 0, (size_t )sizeof(& fx2d));
  memset((void *)(gy2d), 0, (size_t )sizeof(& gy2d));
  io = 0;
  }
  {
  while (1) {
    while_continue: /* CIL Label */ ;
    if (! (io <= 1)) {
      goto while_break;
    }
    {
    HoleHMEPBCs();
    m = 1;
    }
    {
    while (1) {
      while_continue___0: /* CIL Label */ ;
      if (! (m <= 4)) {
        goto while_break___0;
      }
      j = ND - 2;
      {
      while (1) {
        while_continue___1: /* CIL Label */ ;
        if (! (j <= NYE + 2)) {
          goto while_break___1;
        }
        i = ND - 2;
        {
        while (1) {
          while_continue___2: /* CIL Label */ ;
          if (! (i <= NXE + 2)) {
            goto while_break___2;
          }
          bufx2d[i][j] = h2d[i + 1][j][m] - h2d[i][j][m];
          bufy2d[i][j] = h2d[i][j + 1][m] - h2d[i][j][m];
          i ++;
        }
        while_break___22: /* CIL Label */ ;
        }
        while_break___2: 
        j ++;
      }
      while_break___21: /* CIL Label */ ;
      }
      while_break___1: 
      j = ND;
      {
      while (1) {
        while_continue___3: /* CIL Label */ ;
        if (! (j <= NYE + 1)) {
          goto while_break___3;
        }
        i = ND;
        {
        while (1) {
          while_continue___4: /* CIL Label */ ;
          if (! (i <= NXE + 1)) {
            goto while_break___4;
          }
          {
          ux2d[i][j][m] = MM2(theta, bufx2d[i - 1][j], bufx2d[i][j]);
          uy2d[i][j][m] = MM2(theta, bufy2d[i][j - 1], bufy2d[i][j]);
          i ++;
          }
        }
        while_break___24: /* CIL Label */ ;
        }
        while_break___4: 
        j ++;
      }
      while_break___23: /* CIL Label */ ;
      }
      while_break___3: 
      m ++;
    }
    while_break___20: /* CIL Label */ ;
    }
    while_break___0: 
    j = ND - 2;
    {
    while (1) {
      while_continue___5: /* CIL Label */ ;
      if (! (j <= NYE + 3)) {
        goto while_break___5;
      }
      i = ND - 2;
      {
      while (1) {
        while_continue___6: /* CIL Label */ ;
        if (! (i <= NXE + 3)) {
          goto while_break___6;
        }
        den = h2d[i][j][1];
        xmt = h2d[i][j][2];
        ymt = h2d[i][j][3];
        eng = h2d[i][j][4];
        vex = xmt / den;
        vey = ymt / den;
        f2d[i][j][1] = xmt;
        f2d[i][j][2] = (2. / ((3. * mstarhole) * (double )M)) * eng;
        f2d[i][j][3] = 0.;
        f2d[i][j][4] = ((4. / 3.) * eng) * vex;
        g2d[i][j][1] = ymt;
        g2d[i][j][2] = 0.0;
        g2d[i][j][3] = (2. / ((3. * mstarhole) * (double )M)) * eng;
        g2d[i][j][4] = ((4. / 3.) * eng) * vey;
        i ++;
      }
      while_break___26: /* CIL Label */ ;
      }
      while_break___6: 
      j ++;
    }
    while_break___25: /* CIL Label */ ;
    }
    while_break___5: 
    m = 1;
    {
    while (1) {
      while_continue___7: /* CIL Label */ ;
      if (! (m <= 4)) {
        goto while_break___7;
      }
      j = ND - 2;
      {
      while (1) {
        while_continue___8: /* CIL Label */ ;
        if (! (j <= NYE + 2)) {
          goto while_break___8;
        }
        i = ND - 2;
        {
        while (1) {
          while_continue___9: /* CIL Label */ ;
          if (! (i <= NXE + 2)) {
            goto while_break___9;
          }
          bufx2d[i][j] = f2d[i + 1][j][m] - f2d[i][j][m];
          bufy2d[i][j] = g2d[i][j + 1][m] - g2d[i][j][m];
          i ++;
        }
        while_break___29: /* CIL Label */ ;
        }
        while_break___9: 
        j ++;
      }
      while_break___28: /* CIL Label */ ;
      }
      while_break___8: 
      j = ND;
      {
      while (1) {
        while_continue___10: /* CIL Label */ ;
        if (! (j <= NYE + 1)) {
          goto while_break___10;
        }
        i = ND;
        {
        while (1) {
          while_continue___11: /* CIL Label */ ;
          if (! (i <= NXE + 1)) {
            goto while_break___11;
          }
          {
          fx2d[i][j][m] = MM2(theta, bufx2d[i - 1][j], bufx2d[i][j]);
          gy2d[i][j][m] = MM2(theta, bufy2d[i][j - 1], bufy2d[i][j]);
          i ++;
          }
        }
        while_break___31: /* CIL Label */ ;
        }
        while_break___11: 
        j ++;
      }
      while_break___30: /* CIL Label */ ;
      }
      while_break___10: 
      m ++;
    }
    while_break___27: /* CIL Label */ ;
    }
    while_break___7: 
    j = ND;
    {
    while (1) {
      while_continue___12: /* CIL Label */ ;
      if (! (j <= NYE + 1)) {
        goto while_break___12;
      }
      i = ND;
      {
      while (1) {
        while_continue___13: /* CIL Label */ ;
        if (! (i <= NXE + 1)) {
          goto while_break___13;
        }
        den = (h2d[i][j][1] - dtodx2 * fx2d[i][j][1]) - dtody2 * gy2d[i][j][1];
        xmt = (h2d[i][j][2] - dtodx2 * fx2d[i][j][2]) - dtody2 * gy2d[i][j][2];
        ymt = (h2d[i][j][3] - dtodx2 * fx2d[i][j][3]) - dtody2 * gy2d[i][j][3];
        eng = (h2d[i][j][4] - dtodx2 * fx2d[i][j][4]) - dtody2 * gy2d[i][j][4];
        vex = xmt / den;
        vey = ymt / den;
        f2d[i][j][1] = xmt;
        f2d[i][j][2] = (2. / ((3. * mstarhole) * (double )M)) * eng;
        f2d[i][j][3] = 0.0;
        f2d[i][j][4] = ((4. / 3.) * eng) * vex;
        g2d[i][j][1] = ymt;
        g2d[i][j][2] = 0.0;
        g2d[i][j][3] = (2. / ((3. * mstarhole) * (double )M)) * eng;
        g2d[i][j][4] = ((4. / 3.) * eng) * vey;
        i ++;
      }
      while_break___33: /* CIL Label */ ;
      }
      while_break___13: 
      j ++;
    }
    while_break___32: /* CIL Label */ ;
    }
    while_break___12: ;
    if (io == 0) {
      dt = DT;
      if (TEMPO + 2. * dt >= TF) {
        dt = 0.5 * (TF - TEMPO);
      }
    }
    dtodx2 = (0.5 * dt) / dx___0;
    dtody2 = (0.5 * dt) / dy___0;
    m = 1;
    {
    while (1) {
      while_continue___14: /* CIL Label */ ;
      if (! (m <= 4)) {
        goto while_break___14;
      }
      j = (ND + 1) - io;
      {
      while (1) {
        while_continue___15: /* CIL Label */ ;
        if (! (j <= NYE - io)) {
          goto while_break___15;
        }
        i = (ND + 1) - io;
        {
        while (1) {
          while_continue___16: /* CIL Label */ ;
          if (! (i <= NXE - io)) {
            goto while_break___16;
          }
          bufx2d[i][j] = ((0.25 * (((h2d[i][j][m] + h2d[i + 1][j][m]) + h2d[i][j + 1][m]) + h2d[i + 1][j + 1][m]) + 0.0625 * (((((((ux2d[i][j][m] - ux2d[i + 1][j][m]) + ux2d[i][j + 1][m]) - ux2d[i + 1][j + 1][m]) + uy2d[i][j][m]) + uy2d[i + 1][j][m]) - uy2d[i][j + 1][m]) - uy2d[i + 1][j + 1][m])) + dtodx2 * (((f2d[i][j][m] - f2d[i + 1][j][m]) + f2d[i][j + 1][m]) - f2d[i + 1][j + 1][m])) + dtody2 * (((g2d[i][j][m] + g2d[i + 1][j][m]) - g2d[i][j + 1][m]) - g2d[i + 1][j + 1][m]);
          i ++;
        }
        while_break___36: /* CIL Label */ ;
        }
        while_break___16: 
        j ++;
      }
      while_break___35: /* CIL Label */ ;
      }
      while_break___15: 
      j = ND + 1;
      {
      while (1) {
        while_continue___17: /* CIL Label */ ;
        if (! (j <= NYE)) {
          goto while_break___17;
        }
        i = ND + 1;
        {
        while (1) {
          while_continue___18: /* CIL Label */ ;
          if (! (i <= NXE)) {
            goto while_break___18;
          }
          h2d[i][j][m] = bufx2d[i - io][j - io];
          i ++;
        }
        while_break___38: /* CIL Label */ ;
        }
        while_break___18: 
        j ++;
      }
      while_break___37: /* CIL Label */ ;
      }
      while_break___17: 
      m ++;
    }
    while_break___34: /* CIL Label */ ;
    }
    while_break___14: 
    io ++;
  }
  while_break___19: /* CIL Label */ ;
  }
  while_break: ;
  return;
}
}
void Relaxation_Step_Hole(void) 
{ 
  int ND ;
  register int i ;
  register int j ;
  register int c___0 ;
  double taup ;
  double tauw ;
  double ktaup ;
  double ktauw ;
  double t ;
  {
  ND = 2;
  c___0 = 1;
  {
  while (1) {
    while_continue: /* CIL Label */ ;
    if (! (c___0 <= 50)) {
      goto while_break;
    }
    i = ND;
    {
    while (1) {
      while_continue___0: /* CIL Label */ ;
      if (! (i <= nx + ND)) {
        goto while_break___0;
      }
      j = ND;
      {
      while (1) {
        while_continue___1: /* CIL Label */ ;
        if (! (j <= ny + ND)) {
          goto while_break___1;
        }
        t = ((2. / 3.) * (h2d[i][j][4] / h2d[i][j][1])) / (double )KB;
        ktaup = (double )((((M * (double const   )mstarhole) * (double const   )MIU0hole) * (double const   )TL) / Q);
        ktauw = ((MIU0hole * TL) * (double )KB) / (double )((Q * (double const   )VShole) * (double const   )VShole);
        taup = ktaup / t;
        tauw = (0.5 * ktaup) / t + ((1.5 * ktauw) * t) / (t + TL);
        h2d[i][j][4] += (- DT / 50.) * (double )(- Q * (double const   )(h2d[i][j][2] * E[i - 1][j - 1][0] + h2d[i][j][3] * E[i - 1][j - 1][1]) + (double const   )((((h2d[i][j][1] * 1.5) * (double )KB) * (t - TL)) / tauw));
        h2d[i][j][2] += (- DT / 50.) * (((- h2d[i][j][1] * (double )Q) * E[i - 1][j - 1][0]) / (double )(M * (double const   )mstarhole) + h2d[i][j][2] / taup);
        h2d[i][j][3] += (- DT / 50.) * (((- h2d[i][j][1] * (double )Q) * E[i - 1][j - 1][1]) / (double )(M * (double const   )mstarhole) + h2d[i][j][3] / taup);
        j ++;
      }
      while_break___4: /* CIL Label */ ;
      }
      while_break___1: 
      i ++;
    }
    while_break___3: /* CIL Label */ ;
    }
    while_break___0: 
    c___0 ++;
  }
  while_break___2: /* CIL Label */ ;
  }
  while_break: ;
  return;
}
}
void HoleHMEPBCs(void) 
{ 
  int i ;
  int j ;
  double xvel ;
  double yvel ;
  {
  i = 0;
  {
  while (1) {
    while_continue: /* CIL Label */ ;
    if (! (i <= nx + 2)) {
      goto while_break;
    }
    {
    if (EDGE[0][i][0] == (double )0) {
      h2d[i + 2][0][1] = h2d[i + 2][5][1];
      h2d[i + 2][1][1] = h2d[i + 2][4][1];
      h2d[i + 2][2][1] = h2d[i + 2][3][1];
      h2d[i + 2][0][2] = h2d[i + 2][5][2];
      h2d[i + 2][1][2] = h2d[i + 2][4][2];
      h2d[i + 2][2][2] = h2d[i + 2][3][2];
      h2d[i + 2][0][3] = h2d[i + 2][5][3];
      h2d[i + 2][1][3] = h2d[i + 2][4][3];
      h2d[i + 2][2][3] = h2d[i + 2][3][3];
      h2d[i + 2][0][4] = h2d[i + 2][5][4];
      h2d[i + 2][1][4] = h2d[i + 2][4][4];
      h2d[i + 2][2][4] = h2d[i + 2][3][4];
    }
    }
    if (EDGE[0][i][0] == (double )1) {
      goto _L;
    } else
    if (EDGE[0][i][0] == (double )2) {
      _L: 
      yvel = h2d[i + 2][3][3] / h2d[i + 2][3][1];
      h2d[i + 2][0][1] = EDGE[0][i][3];
      h2d[i + 2][1][1] = EDGE[0][i][3];
      h2d[i + 2][2][1] = EDGE[0][i][3];
      h2d[i + 2][0][2] = 0.;
      h2d[i + 2][1][2] = 0.;
      h2d[i + 2][2][2] = 0.;
      h2d[i + 2][0][3] = EDGE[0][i][3] * yvel;
      h2d[i + 2][1][3] = EDGE[0][i][3] * yvel;
      h2d[i + 2][2][3] = EDGE[0][i][3] * yvel;
      h2d[i + 2][0][4] = ((((0.5 * mstarhole) * (double )M) * yvel) * yvel) * EDGE[0][i][3] + ((1.5 * (double )KB) * TL) * EDGE[0][i][3];
      h2d[i + 2][1][4] = ((((0.5 * mstarhole) * (double )M) * yvel) * yvel) * EDGE[0][i][3] + ((1.5 * (double )KB) * TL) * EDGE[0][i][3];
      h2d[i + 2][2][4] = ((((0.5 * mstarhole) * (double )M) * yvel) * yvel) * EDGE[0][i][3] + ((1.5 * (double )KB) * TL) * EDGE[0][i][3];
    }
    i ++;
  }
  while_break___3: /* CIL Label */ ;
  }
  while_break: 
  j = 1;
  {
  while (1) {
    while_continue___0: /* CIL Label */ ;
    if (! (j <= ny + 2)) {
      goto while_break___0;
    }
    if (EDGE[3][j][0] == (double )0) {
      h2d[0][j + 2][1] = h2d[5][j + 2][1];
      h2d[1][j + 2][1] = h2d[4][j + 2][1];
      h2d[2][j + 2][1] = h2d[3][j + 2][1];
      h2d[0][j][2] = h2d[5][j + 2][2];
      h2d[1][j][2] = h2d[4][j + 2][2];
      h2d[2][j][2] = h2d[3][j + 2][2];
      h2d[0][j + 2][3] = h2d[5][j + 2][3];
      h2d[1][j + 2][3] = h2d[4][j + 2][3];
      h2d[2][j + 2][3] = h2d[3][j + 2][3];
      h2d[0][j + 2][4] = h2d[5][j + 2][4];
      h2d[1][j + 2][4] = h2d[4][j + 2][4];
      h2d[2][j + 2][4] = h2d[3][j + 2][4];
    }
    if (EDGE[3][j][0] == (double )1) {
      goto _L___0;
    } else
    if (EDGE[3][j][0] == (double )2) {
      _L___0: 
      xvel = h2d[3][j + 2][2] / h2d[3][j + 2][1];
      h2d[0][j + 2][1] = EDGE[3][j][3];
      h2d[1][j + 2][1] = EDGE[3][j][3];
      h2d[2][j + 2][1] = EDGE[3][j][3];
      h2d[0][j + 2][2] = EDGE[3][j][3] * xvel;
      h2d[1][j + 2][2] = EDGE[3][j][3] * xvel;
      h2d[2][j + 2][2] = EDGE[3][j][3] * xvel;
      h2d[0][j + 2][3] = 0.;
      h2d[1][j + 2][3] = 0.;
      h2d[2][j + 2][3] = 0.;
      h2d[0][j + 2][4] = ((((0.5 * mstarhole) * (double )M) * xvel) * xvel) * EDGE[3][j][3] + ((1.5 * (double )KB) * TL) * EDGE[3][j][3];
      h2d[1][j + 2][4] = ((((0.5 * mstarhole) * (double )M) * xvel) * xvel) * EDGE[3][j][3] + ((1.5 * (double )KB) * TL) * EDGE[3][j][3];
      h2d[2][j + 2][4] = ((((0.5 * mstarhole) * (double )M) * xvel) * xvel) * EDGE[3][j][3] + ((1.5 * (double )KB) * TL) * EDGE[3][j][3];
    }
    j ++;
  }
  while_break___4: /* CIL Label */ ;
  }
  while_break___0: 
  j = 1;
  {
  while (1) {
    while_continue___1: /* CIL Label */ ;
    if (! (j <= ny + 2)) {
      goto while_break___1;
    }
    if (EDGE[1][j][0] == (double )0) {
      h2d[nx + 2][j + 2][1] = h2d[nx + 1][j + 2][1];
      h2d[nx + 3][j + 2][1] = h2d[nx][j + 2][1];
      h2d[nx + 4][j + 2][1] = h2d[nx - 1][j + 2][1];
      h2d[nx + 2][j + 2][2] = h2d[nx + 1][j + 2][2];
      h2d[nx + 3][j + 2][2] = h2d[nx][j + 2][2];
      h2d[nx + 4][j + 2][2] = h2d[nx - 1][j + 2][2];
      h2d[nx + 2][j + 2][3] = h2d[nx + 1][j + 2][3];
      h2d[nx + 3][j + 2][3] = h2d[nx][j + 2][3];
      h2d[nx + 4][j + 2][3] = h2d[nx - 1][j + 2][3];
      h2d[nx + 2][j + 2][4] = h2d[nx + 1][j + 2][4];
      h2d[nx + 3][j + 2][4] = h2d[nx][j + 2][4];
      h2d[nx + 4][j + 2][4] = h2d[nx - 1][j + 2][4];
    }
    if (EDGE[1][j][0] == (double )1) {
      goto _L___1;
    } else
    if (EDGE[1][j][0] == (double )2) {
      _L___1: 
      xvel = h2d[nx - 1][j + 2][2] / h2d[nx - 1][j + 2][1];
      h2d[nx + 2][j + 2][1] = EDGE[1][j][3];
      h2d[nx + 3][j + 2][1] = EDGE[1][j][3];
      h2d[nx + 4][j + 2][1] = EDGE[1][j][3];
      h2d[nx + 2][j + 2][2] = EDGE[1][j][3] * xvel;
      h2d[nx + 3][j + 2][2] = EDGE[1][j][3] * xvel;
      h2d[nx + 4][j + 2][2] = EDGE[1][j][3] * xvel;
      h2d[nx + 2][j + 2][3] = 0.;
      h2d[nx + 3][j + 2][3] = 0.;
      h2d[nx + 4][j + 2][3] = 0.;
      h2d[nx + 2][j + 2][4] = ((((0.5 * mstarhole) * (double )M) * xvel) * xvel) * EDGE[1][j][3] + ((1.5 * (double )KB) * TL) * EDGE[1][j][3];
      h2d[nx + 3][j + 2][4] = ((((0.5 * mstarhole) * (double )M) * xvel) * xvel) * EDGE[1][j][3] + ((1.5 * (double )KB) * TL) * EDGE[1][j][3];
      h2d[nx + 4][j + 2][4] = ((((0.5 * mstarhole) * (double )M) * xvel) * xvel) * EDGE[1][j][3] + ((1.5 * (double )KB) * TL) * EDGE[1][j][3];
    }
    j ++;
  }
  while_break___5: /* CIL Label */ ;
  }
  while_break___1: 
  i = 1;
  {
  while (1) {
    while_continue___2: /* CIL Label */ ;
    if (! (i <= nx + 2)) {
      goto while_break___2;
    }
    if (EDGE[2][i][0] == (double )0) {
      h2d[i + 2][ny + 2][1] = h2d[i + 2][ny + 1][1];
      h2d[i + 2][ny + 3][1] = h2d[i + 2][ny][1];
      h2d[i + 2][ny + 4][1] = h2d[i + 2][ny - 1][1];
      h2d[i + 2][ny + 2][2] = h2d[i + 2][ny + 1][2];
      h2d[i + 2][ny + 3][2] = h2d[i + 2][ny][2];
      h2d[i + 2][ny + 4][2] = h2d[i + 2][ny - 1][2];
      h2d[i + 2][ny + 2][3] = h2d[i + 2][ny + 1][3];
      h2d[i + 2][ny + 3][3] = h2d[i + 2][ny][3];
      h2d[i + 2][ny + 4][3] = h2d[i + 2][ny - 1][3];
      h2d[i + 2][ny + 2][4] = h2d[i + 2][ny + 1][4];
      h2d[i + 2][ny + 3][4] = h2d[i + 2][ny][4];
      h2d[i + 2][ny + 4][4] = h2d[i + 2][ny - 1][4];
    }
    if (EDGE[2][i][0] == (double )1) {
      goto _L___2;
    } else
    if (EDGE[2][i][0] == (double )2) {
      _L___2: 
      yvel = h2d[i + 2][ny - 1][3] / h2d[i + 2][ny - 1][1];
      h2d[i + 2][ny + 2][1] = EDGE[2][i][3];
      h2d[i + 2][ny + 3][1] = EDGE[2][i][3];
      h2d[i + 2][ny + 4][1] = EDGE[2][i][3];
      h2d[i + 2][ny + 2][2] = 0.;
      h2d[i + 2][ny + 3][2] = 0.;
      h2d[i + 2][ny + 4][2] = 0.;
      h2d[i + 2][ny + 2][3] = EDGE[2][i][3] * yvel;
      h2d[i + 2][ny + 3][3] = EDGE[2][i][3] * yvel;
      h2d[i + 2][ny + 4][3] = EDGE[2][i][3] * yvel;
      h2d[i + 2][ny + 2][4] = ((((0.5 * mstarhole) * (double )M) * yvel) * yvel) * EDGE[2][i][3] + ((1.5 * (double )KB) * TL) * EDGE[2][i][3];
      h2d[i + 2][ny + 3][4] = ((((0.5 * mstarhole) * (double )M) * yvel) * yvel) * EDGE[2][i][3] + ((1.5 * (double )KB) * TL) * EDGE[2][i][3];
      h2d[i + 2][ny + 4][4] = ((((0.5 * mstarhole) * (double )M) * yvel) * yvel) * EDGE[2][i][3] + ((1.5 * (double )KB) * TL) * EDGE[2][i][3];
    }
    i ++;
  }
  while_break___6: /* CIL Label */ ;
  }
  while_break___2: ;
  return;
}
}
